\documentclass[12pt, a4paper]{article}
\usepackage[UTF8, fontset=fandol]{ctex}
\usepackage{sectsty}
\usepackage{url}
\usepackage{geometry}
\usepackage{amsmath, amssymb}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{cite}
\usepackage{setspace}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{pgffor}
\usepackage{float}
\usepackage{pgfmath}
\usepackage{caption} % åœ¨å¯¼è¨€åŒºæ·»åŠ 
% è®¾ç½®é¡µé¢è¾¹è·
\geometry{a4paper, top=2.5cm, bottom=2.5cm, left=2.5cm, right=2.5cm}

% è®¾ç½®è¡Œé—´è·
\onehalfspacing

% è®¾ç½®è¶…é“¾æ¥æ ·å¼
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    urlcolor=blue,
    citecolor=black
}

% è®¾ç½®ä»£ç å—æ ·å¼
\lstset{
     basicstyle=\ttfamily\small,
     keywordstyle=\color{blue},
     commentstyle=\color{gray},
     stringstyle=\color{red},
     breaklines=true,
     numbers=left,
     numberstyle=\tiny,
     frame=single,
     language=Python % å¯æ ¹æ®éœ€è¦æ›´æ¢ä¸º C, C++, Java ç­‰
   }


\title{GANç³»åˆ—æ¨¡å‹å®éªŒæŠ¥å‘Š}
\author{é«˜å®¶ç’‡ 3023244275}
\begin{document}



\maketitle
\begin{center}
    \includegraphics[width=0.8\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/512x512_random/random_samples_512_004.jpg}
\end{center}
\begin{center}
\section*{æ‘˜è¦}
\end{center}

åœ¨ AIGC å¦‚æ­¤ç«çˆ†çš„ä»Šå¤©ï¼Œäº†è§£ç”Ÿæˆæ¨¡å‹çš„é¼»ç¥– GAN (arXiv:1406.2661)æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚
GAN æ˜¯æ·±åº¦å­¦ä¹ èŠ±ä¹¦çš„ä½œè€… Ian Goodfellow åœ¨ 2014å¹´çš„ä¸€ç¯‡å·¥ä½œï¼Œå¼•å‘äº†ä¸€è‚¡ GAN ç”Ÿæ¨¡å‹çš„æµªæ½®ï¼Œ
è¿™è‚¡ç”Ÿæˆæ¨¡å‹çš„æµªæ½®ä¸€ç›´æŒç»­åˆ°ç°åœ¨çš„ Diffusion ç³»åˆ—ã€‚

å¦‚ä»Š GPT å¦‚æ­¤å‘è¾¾ï¼Œå¤§éƒ¨åˆ†æŠ¥å‘Šå†…å®¹éƒ½å¯ä»¥ç”± AI ç”Ÿæˆã€‚
æ‰€ä»¥æœ¬æŠ¥å‘Šä¸ä¼šèŠ±ç‰¹åˆ«å¤šçš„ç¯‡å¹…æ¥ä»‹ç»æ¨¡å‹çš„ç†è®ºæ¶æ„æˆ–è€…æ˜¯å…¶ä»–æ­»æ¿çš„å†…å®¹ã€‚ä¸ºäº†å®ç°æœ¬å®éªŒçš„ç»ˆæç›®çš„ï¼šå¸®åŠ©å­¦ç”ŸåŠ æ·±å¯¹ GAN æ¨¡å‹çš„æ¶æ„å’Œè®­ç»ƒçš„ç†è§£ã€‚
\textbf{å› æ­¤æ­¤æŠ¥å‘Šå°†èŠ±è´¹å¤§è§„æ¨¡ç¯‡å¹…æ¥é‡ç‚¹è®¨è®º GAN ç³»åˆ—æ¨¡å‹åœ¨ç»™å®šä¸‹æ¸¸ä»»åŠ¡æ—¶çš„ã€è®­ç»ƒç»†èŠ‚ä¸è®­ç»ƒæŠ€å·§ã€‘ã€‚}

æœ¬å®éªŒå®ç°äº†ï¼š
1ã€GAN åœ¨ MNIST æ•°æ®é›†ä¸Šçš„è®­ç»ƒå’Œæ¨ç†ã€‚
2ã€åœ¨ä¸åŒæ•°æ®é›†ä¸Šè®­ç»ƒäº†å¤šä¸ªæ•°äº¿å‚æ•°è§„æ¨¡çš„ CGANã€‚
3ã€200+ å°æ—¶è®­ç»ƒæ—¶é•¿ï¼Œ60+ è®­ç»ƒæ—¥å¿—æ–‡ä»¶ï¼Œ1000+ æ ·æœ¬å’ŒæŸå¤±å¯è§†åŒ–ã€‚


æœ¬æŠ¥å‘Šæ¢è®¨äº†ï¼š
1ã€å­¦ä¹ ç‡è°ƒåº¦ã€æ­£åˆ™åŒ–ã€æ¨¡å‹ä¿å­˜ä¸åŠ è½½ã€æŸå¤±æ—¥å¿—ä¸é˜¶æ®µå¯è§†åŒ–ç­‰å®ç”¨çš„è®­ç»ƒæŠ€å·§
2ã€æ¨¡å‹è®­ç»ƒä¸­çš„å¼ é‡æ•°æ®å¹¶è¡Œã€åˆ†å¸ƒå¼ä¸æ··åˆç²¾åº¦è®­ç»ƒç­–ç•¥
3ã€æ¨¡å‹è®­ç»ƒä¸­çš„æ•°æ®å¢å¼ºä¸é¢„å¤„ç†æŠ€å·§ï¼Œä»¥åŠè¶…å‚æ•°åˆ†æ
4ã€GAN åœ¨å»ºæ¨¡å¤æ‚æ•°æ®åˆ†å¸ƒæ—¶çš„æ¨¡å¼åå¡Œé—®é¢˜



æœ¬å®éªŒå…¨éƒ¨ä»£ç å’Œæ„å»ºè®°å½•ï¼š\url{https://github.com/slkhms777/GANS}

ç”Ÿæˆæ¨¡å‹ç»¼è¿°ä¸ä¸»æµæ¨¡å‹ä»£ç ï¼š\url{https://github.com/slkhms777/AIGC}



% æ­£æ–‡
\newpage
\begin{center}
\section*{å¼•è¨€}
\end{center}

ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGenerative Adversarial Networks, GANsï¼‰è‡ª 2014 å¹´ç”± Goodfellow ç­‰äººæå‡ºä»¥æ¥ï¼Œå·²æˆä¸ºæ·±åº¦å­¦ä¹ é¢†åŸŸæœ€å…·å½±å“åŠ›çš„åˆ›æ–°ä¹‹ä¸€ã€‚GAN é€šè¿‡ç”Ÿæˆå™¨ä¸åˆ¤åˆ«å™¨çš„å¯¹æŠ—æ€§è®­ç»ƒï¼Œä½¿ç”Ÿæˆå™¨èƒ½å¤Ÿé€æ­¥æå‡ç”Ÿæˆæ ·æœ¬çš„è´¨é‡ï¼Œæœ€ç»ˆè¾¾åˆ°ä»¥å‡ä¹±çœŸçš„æ•ˆæœã€‚

ç„¶è€Œï¼ŒåŸå§‹ GAN åœ¨å®é™…åº”ç”¨ä¸­å¸¸å¸¸é¢ä¸´è®­ç»ƒä¸ç¨³å®šã€æ¨¡å¼åå¡Œï¼ˆmode collapseï¼‰ã€æ¢¯åº¦æ¶ˆå¤±ç­‰é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™äº›æŒ‘æˆ˜ï¼Œç ”ç©¶è€…ä»¬æå‡ºäº†å¤šç§æ”¹è¿›æ¨¡å‹ï¼Œå…¶ä¸­è¾ƒä¸ºå…¸å‹çš„åŒ…æ‹¬ Wasserstein GANï¼ˆWGANï¼‰å’Œæ¡ä»¶ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆConditional GAN, CGANï¼‰ã€‚

\textbf{WGANï¼ˆWasserstein GANï¼‰} é’ˆå¯¹è®­ç»ƒä¸ç¨³å®šå’Œæ¨¡å¼åå¡Œé—®é¢˜è¿›è¡Œäº†æœ‰æ•ˆæ”¹è¿›ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é‡‡ç”¨ Wasserstein è·ç¦»ï¼ˆåˆç§° Earth Mover è·ç¦»ï¼‰æ¥è¡¡é‡çœŸå®åˆ†å¸ƒä¸ç”Ÿæˆåˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼Œæ›¿ä»£äº†åŸå§‹ GAN ä¸­çš„ JS æ•£åº¦ã€‚WGAN çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š

1. ä»¥ Wasserstein è·ç¦»ä¸ºæŸå¤±å‡½æ•°ï¼Œæå‡è®­ç»ƒç¨³å®šæ€§ï¼›

2. åˆ¤åˆ«å™¨ï¼ˆCriticï¼‰è¾“å‡ºå®æ•°å€¼è€Œéæ¦‚ç‡ï¼›

3. é€šè¿‡æƒé‡è£å‰ªï¼ˆweight clippingï¼‰æ»¡è¶³ Lipschitz è¿ç»­æ€§çº¦æŸï¼›

4. æŸå¤±å‡½æ•°ä¸ç”Ÿæˆæ ·æœ¬è´¨é‡æ­£ç›¸å…³ï¼Œä¾¿äºè®­ç»ƒè¿‡ç¨‹ç›‘æ§ã€‚

åœ¨æ­¤åŸºç¡€ä¸Šï¼Œ\textbf{WGAN-GPï¼ˆWGAN with Gradient Penaltyï¼‰} è¿›ä¸€æ­¥ç”¨æ¢¯åº¦æƒ©ç½šï¼ˆgradient penaltyï¼‰æ›¿ä»£æƒé‡è£å‰ªï¼Œå¸¦æ¥äº†æ›´å¥½çš„ Lipschitz çº¦æŸï¼Œé¿å…äº†æ¢¯åº¦æ¶ˆå¤±æˆ–çˆ†ç‚¸ç­‰é—®é¢˜ï¼Œä½¿è®­ç»ƒæ›´åŠ ç¨³å®šï¼Œç”Ÿæˆè´¨é‡è¿›ä¸€æ­¥æå‡ã€‚

\textbf{CGANï¼ˆConditional GANï¼‰} åˆ™åœ¨ GAN æ¡†æ¶ä¸­å¼•å…¥äº†æ¡ä»¶ä¿¡æ¯ï¼Œä½¿å¾—ç”Ÿæˆè¿‡ç¨‹å¯æ§ã€‚ä¸åŸå§‹ GAN çš„æ— æ¡ä»¶ç”Ÿæˆä¸åŒï¼ŒCGAN èƒ½å¤Ÿæ ¹æ®è¾“å…¥çš„ç±»åˆ«æ ‡ç­¾ç­‰æ¡ä»¶ç”Ÿæˆç‰¹å®šç±»å‹çš„æ ·æœ¬ã€‚å…¶æ ¸å¿ƒæ€æƒ³åŒ…æ‹¬ï¼š

1. ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨å‡ä»¥æ¡ä»¶ä¿¡æ¯ $c$ ä½œä¸ºè¾“å…¥ï¼›

2. ç”Ÿæˆå™¨ $G(z, c)$ ä»¥å™ªå£° $z$ å’Œæ¡ä»¶ $c$ ç”Ÿæˆæ ·æœ¬ï¼›

3. åˆ¤åˆ«å™¨ $D(x, c)$ åˆ¤æ–­æ ·æœ¬ $x$ åœ¨æ¡ä»¶ $c$ ä¸‹çš„çœŸå®æ€§ï¼›

4. æ”¯æŒæŒ‰éœ€ç”Ÿæˆç‰¹å®šç±»åˆ«æ ·æœ¬ï¼Œæå‡ç”Ÿæˆå¤šæ ·æ€§å’Œè®­ç»ƒç¨³å®šæ€§ã€‚

\textbf{BigGAN} æ˜¯ Google äº 2018 å¹´æå‡ºçš„å¤§è§„æ¨¡é«˜åˆ†è¾¨ç‡å›¾åƒç”Ÿæˆæ¨¡å‹ï¼Œåœ¨ ImageNet ç­‰æ•°æ®é›†ä¸Šå–å¾—äº†çªç ´æ€§æˆæœã€‚BigGAN é€šè¿‡æ‰©å¤§æ¨¡å‹è§„æ¨¡ã€å¼•å…¥è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆSelf-Attentionï¼‰ã€è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰ã€ç±»åˆ«æ¡ä»¶ BatchNorm ä»¥åŠæˆªæ–­æŠ€å·§ï¼ˆTruncation Trickï¼‰ç­‰æ–¹æ³•ï¼Œæå¤§æå‡äº†ç”Ÿæˆå›¾åƒçš„è´¨é‡å’Œå¤šæ ·æ€§ã€‚å…¶ä¸»è¦åˆ›æ–°ç‚¹åŒ…æ‹¬ï¼š

1. å¤§è§„æ¨¡è®­ç»ƒï¼ˆæ›´å¤§çš„ batch size å’Œæ›´æ·±çš„ç½‘ç»œç»“æ„ï¼‰ï¼›

2. åœ¨ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨ä¸­å¼•å…¥ Self-Attention æœºåˆ¶ï¼›

3. è°±å½’ä¸€åŒ–ç¨³å®šè®­ç»ƒè¿‡ç¨‹ï¼›

4. ç±»åˆ«æ¡ä»¶ BatchNorm å¢å¼ºç±»åˆ«ä¿¡æ¯åˆ©ç”¨ï¼›

5. æˆªæ–­æŠ€å·§æå‡æ¨ç†é˜¶æ®µç”Ÿæˆè´¨é‡ã€‚

BigGAN çš„æˆåŠŸéªŒè¯äº†â€œè§„æ¨¡å³åŠ›é‡â€çš„ç†å¿µï¼Œä¸ºåç»­å¦‚ StyleGANã€DALL-E ç­‰æ›´å¤§è§„æ¨¡ç”Ÿæˆæ¨¡å‹çš„å‘å±•å¥ å®šäº†åŸºç¡€ã€‚

æœ¬å®éªŒä»¥ MNISTã€Animal-Faces åŠ ImageNet-1k ç­‰æ•°æ®é›†ä¸ºåŸºç¡€ï¼Œé‡ç‚¹æ¢è®¨äº†ä¸Šè¿°æ¨¡å‹çš„è®­ç»ƒæŠ€å·§åŠç”Ÿæˆç»“æœçš„å¯è§£é‡Šæ€§åˆ†æã€‚
% ç›®å½•é¡µ
\newpage
\tableofcontents

\newpage
\section{ä»»åŠ¡ä¸€ï¼ŒäºŒï¼šGANï¼ŒWGANï¼ŒCGAN åœ¨ MNIST ä¸Šçš„è®­ç»ƒä»¥åŠæ¨ç†}
\subsection{å®éªŒè®¾ç½®ä¸æ–¹æ³•}
\subsubsection{å®éªŒè®¾ç½®}
\begin{itemize}
    \item æ¨¡å‹æ¶æ„ï¼šç®€å•çš„MLPç½‘ç»œä½œä¸ºç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨
    \item æ•°æ®é›†ï¼šMNIST æ‰‹å†™æ•°å­—æ•°æ®é›†
    \item ç¡¬ä»¶ï¼š2å¼  NVIDIA RTX 3090 GPU 
\end{itemize}

\subsubsection{å®éªŒæ–¹æ³•}
åœ¨mnistæ•°æ®é›†ä¸Šï¼Œè®­ç»ƒGANï¼ŒWGANã€‚é€šè¿‡éšæœºé‡‡æ ·å™ªå£°å‘é‡ç”Ÿæˆæ‰‹å†™æ•°å­—å›¾åƒã€‚
CGANç•¥æœ‰ä¸åŒï¼ŒCGANæ”¯æŒç±»åˆ«æ”¶å…¥ï¼Œå› æ­¤å¯ä»¥æŒ‡å®šç”Ÿæˆç‰¹å®šç±»åˆ«çš„æ‰‹å†™æ•°å­—ã€‚

\subsubsection{ä»£ç ç¤ºä¾‹ï¼ˆä»…ç»™å‡ºGANçš„ä»£ç ç¤ºä¾‹ï¼‰}

\begin{lstlisting}[language=Python, caption=GAN è®­ç»ƒä¸»å¾ªç¯ç¤ºä¾‹]
class Generator(nn.Module):
    def __init__(self, img_size, noise_size, num_hiddens, out_channels=1):
        super().__init__()
        self.img_size = img_size
        self.out_channels = out_channels
        self.fc1 = nn.Linear(noise_size, num_hiddens)
        self.bn1 = nn.BatchNorm1d(num_hiddens)
        self.fc2 = nn.Linear(num_hiddens, num_hiddens)
        self.bn2 = nn.BatchNorm1d(num_hiddens)
        self.fc3 = nn.Linear(num_hiddens, img_size * img_size * out_channels)
        self.relu = nn.LeakyReLU()
        self.tanh = nn.Tanh()

    def forward(self, noise):
        x = self.relu(self.bn1(self.fc1(noise)))
        x = self.relu(self.bn2(self.fc2(x)))
        x = self.tanh(self.fc3(x))
        x = x.view(-1, self.out_channels, self.img_size, self.img_size)
        return x

class Discriminator(nn.Module):
    def __init__(self, img_size, num_hiddens, in_channels=1):
        super().__init__()
        self.flt = nn.Flatten()
        self.fc1 = nn.Linear(img_size * img_size * in_channels, num_hiddens)
        self.dropout1 = nn.Dropout(0.3)
        self.fc2 = nn.Linear(num_hiddens, num_hiddens)
        self.dropout2 = nn.Dropout(0.3)
        self.fc3 = nn.Linear(num_hiddens, 1)
        self.relu = nn.LeakyReLU()
    def forward(self, image):
        x = self.flt(image)
        x = self.relu(self.fc1(x))
        x = self.dropout1(x)
        x = self.relu(self.fc2(x))
        x = self.dropout2(x)
        x = self.fc3(x)
        return x

for epoch in range(num_epochs):
    for real_imgs, _ in dataloader:
        # åˆ¤åˆ«å™¨è®­ç»ƒ
        ç”Ÿæˆå™ªå£° noise
        ç”¨ç”Ÿæˆå™¨ç”Ÿæˆå‡å›¾åƒ fake_imgs = Generator(noise)
        åˆ¤åˆ«å™¨åˆ¤åˆ«çœŸå®å›¾ç‰‡ outputs_real = Discriminator(real_imgs)
        åˆ¤åˆ«å™¨åˆ¤åˆ«å‡å›¾ç‰‡ outputs_fake = Discriminator(fake_imgs.detach())
        è®¡ç®—åˆ¤åˆ«å™¨æŸå¤± loss_d = criterion(outputs_real, 1) + criterion(outputs_fake, 0)
        åˆ¤åˆ«å™¨åå‘ä¼ æ’­å’Œä¼˜åŒ–

        # ç”Ÿæˆå™¨è®­ç»ƒ
        ç”Ÿæˆæ–°çš„å™ªå£° noise
        ç”¨ç”Ÿæˆå™¨ç”Ÿæˆå‡å›¾åƒ fake_imgs = Generator(noise)
        åˆ¤åˆ«å™¨åˆ¤åˆ«å‡å›¾ç‰‡ outputs = Discriminator(fake_imgs)
        è®¡ç®—ç”Ÿæˆå™¨æŸå¤± loss_g = criterion(outputs, 1)
        ç”Ÿæˆå™¨åå‘ä¼ æ’­å’Œä¼˜åŒ–

    è®°å½•å¹¶æ‰“å°æ¯ä¸ªepochçš„æŸå¤±ï¼Œå®šæœŸä¿å­˜æ¨¡å‹æƒé‡ï¼Œå®šæœŸç”Ÿæˆæ ·æœ¬å›¾ç‰‡
\end{lstlisting}

\subsection{è®­ç»ƒç»†èŠ‚ä¸è®­ç»ƒæŠ€å·§}
\subsubsection{æ­£åˆ™åŒ–}
åœ¨ä¸€èˆ¬çš„æ·±åº¦å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œæ­£åˆ™åŒ–æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç¯èŠ‚ï¼Œå› ä¸ºå¦‚æœç¡®å®æœ‰æ•ˆçš„æ­£åˆ™åŒ–ï¼Œæ¨¡å‹å¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆåˆ°æ•°æ®é›†ä¸Šï¼Œå¯¼è‡´
æ¨¡å‹çš„æ³›åŒ–æ€§å¤§å¤§é™ä½ã€‚å¸¸è§çš„æ­£åˆ™åŒ–æœ‰dropoutå’Œweight decayï¼ŒäºŒè€…è™½ç„¶å®ç°æ–¹å¼ä¸åŒï¼Œä½†æœ¬è´¨ä¸Šéƒ½æ˜¯é˜²æ­¢éƒ¨åˆ†ç¥ç»å…ƒ
åœ¨æ•´ä¸ªæ¨¡å‹ä¸­dominateã€‚å¯¹äºweight decayï¼Œé‡‡ç”¨é™åˆ¶ä¸€éƒ¨åˆ†ç¥ç»å…ƒçš„æƒé‡å¤§å°çš„æ–¹å¼æ¥é˜²æ­¢è¿‡æ‹Ÿåˆã€‚è€Œdropoutåˆ™ç›´æ¥
ä¸¢å¼ƒéƒ¨åˆ†ç¥ç»å…ƒæ¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼ŒäºŒè€…åœ¨åŸç†ä¸Šæœ‰å¼‚æ›²åŒå·¥ã€‚

ä½†æ˜¯é’ˆå¯¹ä»»åŠ¡ä¸€ï¼ŒäºŒï¼Œæ­£åˆ™åŒ–çš„ä½œç”¨å¾€å¾€ä¸é‚£ä¹ˆæ˜æ˜¾ã€‚ç”±äºmnistæ•°æ®é›†æœ¬èº«çš„ç‰¹æ€§ï¼Œç›¸åŒæ•°å­—çš„ä¸åŒå½¢æ€å·®å¼‚å¾€å¾€éå¸¸å°ï¼Œ
æ­£å¦‚æœ¬å®éªŒæŒ‡å¯¼pptä¸­æ‰€å±•ç¤ºçš„åƒç´ åˆ†å¸ƒçƒ­åŠ›å›¾ï¼ŒåŒä¸€ä¸ªæ•°å­—çš„åˆ†å¸ƒéå¸¸é›†ä¸­ã€‚å› æ­¤ä»ç”Ÿæˆè´¨é‡è¿™ä¸ªè§’åº¦å‡ºå‘ï¼Œæˆ‘ä»¬ç”šè‡³æœ‰ä¸€ç‚¹
å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿè¿‡æ‹Ÿåˆï¼Œä¸å»é™åˆ¶ç¥ç»å…ƒçš„dominateã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ•°å­—8æ˜¾è‘—çš„ç‰¹å¾ä¹‹ä¸€å°±æ˜¯ä¸¤ä¸ªåœˆåœˆäº¤æ±‡å¤„ï¼Œå½¢å¦‚â€œxâ€ï¼Œå› æ­¤
è¿™ä¸ªç‰¹å¾åŸºæœ¬å¯ä»¥ä½œä¸ºæ•°å­—8çš„â€œèº«ä»½è¯â€ï¼Œæˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿè®°ä½è¿™ä¸ªâ€œèº«ä»½è¯â€ï¼Œè‡³äºä¸Šä¸‹ä¸¤ä¸ªåœˆï¼Œç˜¦ä¸€ç‚¹ï¼Œèƒ–ä¸€ç‚¹ï¼Œå®½ä¸€ç‚¹ï¼Œ
æ‰ä¸€ç‚¹â€¦â€¦éƒ½ä¸å½±å“æ•°å­—8çš„æ•´ä½“æ ·è²Œã€‚å› æ­¤æˆ‘åœ¨æ¨¡å‹è®¾è®¡æ—¶é‡‡ç”¨äº†æ¯”è¾ƒå°çš„ä¸¢å¼ƒç‡ï¼Œè€Œä¸”ä»…å¯¹åˆ¤åˆ«å™¨ä½¿ç”¨ï¼Œå¸Œæœ›åˆ¤åˆ«å™¨ç¨å¾®æ”¾å®½éš¾åº¦ã€‚

é˜²æ­¢è¿‡æ‹Ÿåˆæ˜¯æ­£åˆ™åŒ–ä¹‹äºç”Ÿæˆæ¨¡å‹çš„ç¬¬ä¸€ä½œç”¨ï¼Œè‡³äºæ­£åˆ™åŒ–ä¹‹äºç”Ÿæˆæ¨¡å‹ç¬¬äºŒä½œç”¨ï¼Œæˆ‘æƒ³å¤§æŠµæ˜¯ä¿è¯ç”Ÿæˆæ ·æœ¬çš„å¤šæ ·æ€§ã€‚
å°±å¥½æ¯”æ•°å­—1æœ‰ç¬”ç›´çš„å½¢æ€ï¼Œä¹Ÿæœ‰æ–œä½“çš„å½¢æ€ï¼Œæˆ‘ä»¬å½“ç„¶å¸Œæœ›æ¨¡å‹åœ¨ç”Ÿæˆæ•°å­—1çš„æ—¶å€™åœ¨èƒ½å¤Ÿè¯†åˆ«å‡ºçš„å‰æä¸‹ï¼Œè¿˜èƒ½å¤Ÿæœ‰
å„ç§è§’åº¦çš„å€¾æ–œï¼Œä»¥è¾¾åˆ°å¤šæ ·æ€§ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º

\vspace{1cm}


\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.5\textwidth]{/Users/slkgaw/Proj/GANS/visual/CGAN/cgan_sample_epoch_200.png}
\end{figure}

\newpage
\subsubsection{è¶…å‚æ•°è°ƒæ•´}
GANç³»åˆ—ç®—æ˜¯å¯¹è¶…å‚æ•°æ¯”è¾ƒæ•æ„Ÿçš„ä¸€ç³»åˆ—æ¨¡å‹äº†ã€‚é¦–å…ˆï¼Œå¦‚æœè¶…å‚æ•°è°ƒæ•´ä¸å½“ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨çš„å‚æ•°é‡ä¸matchï¼Œ
å¦‚æœç›¸æ¯”ä¹‹ä¸‹åˆ¤åˆ«å™¨çš„å‚æ•°é‡è¿‡å¤šï¼Œåˆ™ä¼šè¿‡äºä¸¥è‹›ï¼Œä¼šä¿ƒè¿›ç”Ÿæˆå™¨ä½œå¼Šï¼Œåªç”Ÿæˆä¸€å°éƒ¨åˆ†ç§ç±»ï¼Œä»è€Œå¤§å¹…é™ä½ç”Ÿæˆå›¾ç‰‡çš„å¤šæ ·æ€§ã€‚
å¦‚æœç›¸æ¯”ä¹‹ä¸‹åˆ¤åˆ«å™¨çš„å‚æ•°é‡è¿‡å°‘ï¼Œåˆ™ä¼šè¿‡äºæ”¾å…»ï¼Œä¼šä¿ƒè¿›ç”Ÿæˆå™¨å·æ‡’ï¼Œåªç”Ÿæˆå¤§è‡´è½®å»“å³å¯ï¼Œä»è€Œå¤§å¹…é™ä½ç”Ÿæˆå›¾ç‰‡çš„è´¨é‡ã€‚
è€Œè¿™ä»…ä»…åªæ˜¯ä»æ¨¡å‹å‚æ•°é‡çš„è§’åº¦çš„å®šæ€§åˆ†æã€‚åœ¨å®é™…è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¸åŒçš„trickå¯¹æ¨¡å‹è®­ç»ƒæœ‰ä¸åŒçš„å½±å“ã€‚
è¶…å‚æ•°é€‰æ‹©å…·ä½“å¦‚ä¸‹ï¼š
\begin{itemize}
    \item \texttt{batch\_size = 256}
    \item \texttt{noise\_size = 64}
    \item \texttt{num\_hiddens = 512}
    \item \texttt{num\_epochs = 200}
    \item \texttt{learning\_rate = 0.0002}
\end{itemize}

\vspace{0.5cm}
å™ªå£°é€‰æ‹©64æ˜¯å› ä¸ºmnistæ•°æ®æœ¬èº«ä¸ç®—å¤æ‚ï¼Œ64è¶³çŸ£ï¼Œnum\_hiddensé€‰æ‹©512åˆ™æ˜¯æƒ³è®©æ¨¡å‹å°½å¯èƒ½å¤šåœ°å›Šæ‹¬æ•°æ®ç»†èŠ‚å’Œå¤šæ ·æ€§åˆ†å¸ƒã€‚
è¿™ä¸¤ä¸ªè¶…å‚æ•°çš„å½±å“ä¹Ÿæ¯”è¾ƒç›´è§‚ï¼Œä¸è¿‡å¤šèµ˜è¿°ã€‚

ç¬¬ä¸€ä¸ªå€¼å¾—æ¢è®¨çš„è¶…å‚æ•°æ˜¯batchå¤§å°ï¼Œä¸ºä»€ä¹ˆåœ¨æ˜¾å­˜å¾ˆå……è¶³çš„æƒ…å†µä¸‹ä»ç„¶é€‰æ‹©256çš„å­¦ä¹ ç‡ï¼Ÿä¸ºä»€ä¹ˆä¸ç›´æ¥ä¸Š4096çš„batchå¤§å°ï¼Ÿ
å…¶å®256çš„batchå¤§å°ä¸ç®—å¾ˆå°ï¼Œåªä¸è¿‡æ˜¯mnistæ•°æ®å›¾ç‰‡sizeå¾ˆå°å¯ä»¥ç¨å¾®ç¿»ä¸ªå€ã€‚é€‰æ‹©ä¸åƒæ»¡æ˜¾å­˜ä¹Ÿæ˜¯mnistæ•°æ®é›†çš„åŸå› ã€‚
ç»å®éªŒå‘ç°ï¼Œbatché€‰æ‹©è¿‡å¤§è™½ç„¶å¯ä»¥æ˜æ˜¾åŠ é€Ÿè®­ç»ƒï¼Œä½†æ˜¯ä¼šå¯¼è‡´è®­ç»ƒéå¸¸ä¸ç¨³å®šï¼Œå¤§bacthå¸¦æ¥çš„å¤§æ¢¯åº¦å¯¹å°æ•°æ®é›†ä¼šå¸¦æ¥å¾ˆå¤§çš„
éœ‡è¡ã€‚æœ€ç»ˆå®¹æ˜“å¯¹ç”Ÿæˆçš„å›¾ç‰‡äº§ç”Ÿå½±å“ï¼Œå¦‚äº§ç”Ÿå™ªç‚¹å’Œéƒ¨åˆ†ç»†èŠ‚ç¼ºå¤±ã€‚è€Œbatché€‰æ‹©å¤ªå°åˆ™ä¼šå¯¹æ•°æ®å™ªå£°æ•æ„Ÿï¼ŒåŒæ ·ä¼šå¸¦æ¥ç”Ÿæˆå›¾ç‰‡
è´¨é‡ä¸‹é™çš„é—®é¢˜ã€‚

ç¬¬äºŒä¸ªå€¼å¾—è®¨è®ºçš„è¶…å‚æ•°æ˜¯å­¦ä¹ ç‡å’Œnum\_epochsçš„ç»„åˆé€‰æ‹©ã€‚åœ¨æœ¬å®éªŒä¸­ä¸ºäº†è®­ç»ƒè¿‡ç¨‹æµç¨‹ï¼Œç”Ÿæˆå›¾ç‰‡çš„è´¨é‡ç¨³å®šï¼Œé€‰æ‹©äº†å°å­¦ä¹ ç‡
+å¤šepochçš„è®­ç»ƒç­–ç•¥ã€‚ä»å®šæ€§çš„è§’åº¦ä¸Šåˆ†æï¼Œå¤šepochè¡¨ç¤ºå­¦çš„ä¹…ï¼Œå°å­¦ä¹ ç‡è¡¨ç¤ºå­¦çš„ç»†ã€‚è™½è¯´å°å­¦ä¹ ç‡å¸¦æ¥æ›´å¥½çš„å­¦ä¹ æ•ˆæœ
æ˜¯ä¸€ç§ç»éªŒä¸»ä¹‰ï¼Œä½†è¿˜æ˜¯å¯ä»¥ä»ä¸€äº›æ•°å­¦çš„è§’åº¦åˆ†æå¾—æ¥çš„ã€‚æ‰€è°“çš„æ¢¯åº¦ä¸‹é™ç®—æ³•å°±æ˜¯ä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜ã€‚åœ¨è§£ç©ºé—´ä¸­ï¼Œç»´åº¦å¾ˆé«˜å¯¼è‡´
å¾ˆéš¾ç”¨æ˜¾å¼çš„æ–¹å¼è¡¨ç°ï¼Œä½†å¯ä»¥ç±»æ¯”ä¸‰ç»´ç©ºé—´ã€‚ä¸‰ç»´ç©ºé—´çš„æœ€ä¼˜åŒ–é—®é¢˜å…¶å®å°±æ˜¯ä¸€åº§ä¸€åº§å±±ä¸˜ï¼Œä¸€åº§åº§å±±ä¸˜ä¹Ÿè¢«ç§°ä½œæ¢¯åº¦æ™¯è§‚ã€‚
è€Œåœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œæ¢¯åº¦æ™¯è§‚æ˜¯ååˆ†å¤æ‚çš„ï¼Œå¦‚æœå­¦ä¹ ç‡åå¤§ï¼Œåˆ™ä¼šå¯¼è‡´åœ¨æœ€ä¼˜ç‚¹çš„â€œå‘â€é™„è¿‘åå¤æ¨ªè·³ï¼Œæ— æ³•æ·±å…¥ä¸‹ä¸€é˜¶æ®µçš„ç‰¹å¾å­¦ä¹ ï¼Œ
è¿™æ­£æ˜¯å­¦ä¹ ç‡é€‰æ‹©è¾ƒå°å€¼çš„ç†è®ºä¾æ®ã€‚åŒæ—¶ä¹Ÿæ­£å› ä¸ºè¿™ç§æ¢¯åº¦æ™¯è§‚çš„å¤æ‚æ€§å’Œå±‚æ¬¡æ€§ï¼Œä¹Ÿå¼•å‡ºäº†ä¸€ç³»åˆ—å­¦ä¹ ç‡æŠ€å·§ï¼Œå¦‚æœ€å…¸å‹çš„scheduleæ–¹æ¡ˆ
ï¼ˆåœ¨åç»­åˆ†æä¸­æœ‰æåŠï¼‰èƒ½å¤Ÿä¿ƒä½¿æ¨¡å‹åœ¨æ—©æœŸepochå­¦ä¹ å¤§è‡´ç‰¹å¾ï¼Œè€Œåœ¨ä¸­åæœŸé€æ¸å­¦ä¹ ç»†èŠ‚ç‰¹å¾ã€‚


\subsubsection{å•æœºå¤šå¡å¹¶è¡Œ}
æ·±åº¦å­¦ä¹ çš„å‘å±•ç¦»ä¸å¼€ç®—åŠ›çš„æ”¹è¿›ï¼Œå› æ­¤æœ¬å®éªŒé€‰æ‹©å•æœºåŒå¡æ¥è¿›è¡Œå¼ é‡æ•°æ®å¹¶è¡Œã€‚
ä»¥ä¸‹æ˜¯å•æœºå¤šå¡çš„ä»£ç ç¤ºä¾‹:
\begin{lstlisting}[language=Python, caption=GAN è®­ç»ƒä¸»å¾ªç¯ç¤ºä¾‹]
# 1. æ„å»ºæ¨¡å‹
generator = Generator(...)
discriminator = Discriminator(...)

# 2. å¤šå¡åŒ…è£…
if GPUæ•°é‡ > 1:
    generator = DataParallel(generator)
    discriminator = DataParallel(discriminator)

# 3. è®­ç»ƒå’Œä¿å­˜æƒé‡æ—¶ï¼Œè·å–åŸå§‹æ¨¡å‹
if isinstance(generator, DataParallel):
    generator_module = generator.module
    discriminator_module = discriminator.module
else:
    generator_module = generator
    discriminator_module = discriminator

# 4. ä¿å­˜æ¨¡å‹
torch.save: generator_module.state_dict()
torch.save: discriminator_module.state_dict()

# 5. åŠ è½½æ¨¡å‹
if isinstance(generator, DataParallel):
    generator.module.load_state_dict(...)
else:
    generator.load_state_dict(...)
\end{lstlisting}

éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœè¦ä¿å­˜ã€åŠ è½½æ¨¡å‹å‚æ•°ï¼Œæˆ–è€…ç›´æ¥è®¿é—®æ¨¡å‹çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ç­‰ï¼Œå¿…é¡»è¦ç”¨.moduleå±æ€§æ¥è®¿é—®ã€‚
ä½†æ˜¯åœ¨å‰å‘å’Œæ¨ç†æ—¶ï¼Œåˆ™åè€Œä¸è¦ç”¨.moduleï¼Œè¿™æ ·å¯ä»¥ä¿è¯å¼ é‡æ•°æ®è‡ªåŠ¨åˆ†é…åˆ°å¤šå¡ä»è€Œè¿›è¡Œå¹¶è¡Œã€‚
å…¶æ¬¡ï¼Œæ¨¡å‹éœ€è¦å…ˆ to(device) å† DataParallelï¼Œå¦åˆ™å¤šå¡æ—¶å‚æ•°å¯èƒ½ä¸åœ¨åŒä¸€è®¾å¤‡ä¸Šï¼Œå¹¶ä¸”å¤šå¡è®­ç»ƒæ—¶
 batch\_size è¦è¶³å¤Ÿå¤§ï¼Œå¦åˆ™æ¯å¡çš„æ•°æ®å¤ªå°‘ï¼Œæ•ˆç‡ä½ä¸‹ã€‚

\newpage
\subsubsection{å¤šepoch + å­¦ä¹ ç‡schedule}
åœ¨æœ¬å®éªŒä¸­ä¸ºäº†è®­ç»ƒè¿‡ç¨‹æµç¨‹ï¼Œç”Ÿæˆå›¾ç‰‡çš„è´¨é‡ç¨³å®šï¼Œé€‰æ‹©äº†å¤šepoch + å­¦ä¹ ç‡scheduleçš„è®­ç»ƒç­–ç•¥ã€‚
ä»å®šæ€§çš„è§’åº¦ä¸Šåˆ†æï¼Œå¤šepochè¡¨ç¤ºå­¦çš„ä¹…ï¼Œå°å­¦ä¹ ç‡è¡¨ç¤ºå­¦çš„ç»†ï¼Œå­¦ä¹ ç‡scheduleè¡¨ç¤ºå­¦å¾—æ·±ã€‚ç”±äºmnistæ•°æ®é›†æœ¬èº«çš„ç‰¹æ€§
ä¸å¿…ç”¨éå¸¸å¤æ‚çš„scheduleæŠ€å·§ï¼Œå› æ­¤åœ¨ä»»åŠ¡ä¸€ã€äºŒä¸­ä»…ä½¿ç”¨æ™®é€šçš„ç­‰æ¯”ç¼©å°ç­–ç•¥ï¼Œä»£ç å¦‚ä¸‹ï¼š
\begin{lstlisting}
# 1. åˆå§‹åŒ–
å®šä¹‰ Generator å’Œ Discriminator
å¦‚å¤šGPUåˆ™ç”¨ DataParallel åŒ…è£…
å®šä¹‰ä¼˜åŒ–å™¨ optimizer_g, optimizer_d
å®šä¹‰å­¦ä¹ ç‡è°ƒåº¦å™¨ scheduler_g, scheduler_d
å®šä¹‰æŸå¤±å‡½æ•° criterion

# 2. ä¼˜åŒ–å™¨ä¸å­¦ä¹ ç‡è°ƒåº¦
optimizer_g = Adam(generatorå‚æ•°)
optimizer_d = Adam(discriminatorå‚æ•°)
scheduler_g = StepLR(optimizer_g, æ¯50epochå­¦ä¹ ç‡*0.5)
scheduler_d = StepLR(optimizer_d, æ¯50epochå­¦ä¹ ç‡*0.5)

# 3. è®­ç»ƒå¾ªç¯
for epoch in num_epochs:
    for real_imgs in dataloader:
        # åˆ¤åˆ«å™¨è®­ç»ƒ
        ç”Ÿæˆå™ªå£° noise
        ç”¨ generator ç”Ÿæˆ fake_imgs
        åˆ¤åˆ«å™¨åˆ†åˆ«åˆ¤åˆ« real_imgs å’Œ fake_imgs
        è®¡ç®—åˆ¤åˆ«å™¨æŸå¤± loss_d
        ä¼˜åŒ–åˆ¤åˆ«å™¨

        # ç”Ÿæˆå™¨è®­ç»ƒ
        ç”Ÿæˆå™ªå£° noise
        ç”¨ generator ç”Ÿæˆ fake_imgs
        åˆ¤åˆ«å™¨åˆ¤åˆ« fake_imgs
        è®¡ç®—ç”Ÿæˆå™¨æŸå¤± loss_g
        ä¼˜åŒ–ç”Ÿæˆå™¨

    scheduler_g.step()
    scheduler_d.step()
    å®šæœŸä¿å­˜æ¨¡å‹æƒé‡ä¸ç”Ÿæˆæ ·æœ¬
    è®°å½•æŸå¤±

\end{lstlisting}


\subsubsection{æ¨¡å‹ä¿å­˜ä¸å¯è§†åŒ–}

å¤šepochçš„è®­ç»ƒå¿…é¡»è¦æœ‰ä¿å­˜æ¨¡å‹çš„ä¹ æƒ¯ï¼Œä¸€æ˜¯åç»­å¯ä»¥ç›´æ¥åŠ è½½å†å²æ¨¡å‹å‚æ•°è¿›è¡Œåˆ†æï¼ŒäºŒæ˜¯é˜²æ­¢è®­ç»ƒæ„å¤–ç»ˆæ­¢é€ æˆæˆæœ¬æŸå¤±ã€‚
åœ¨æœ¬å®éªŒä¸­ï¼Œæ•°æ®é›†å¾ˆç®€å•å› æ­¤åªä¿å­˜æ¨¡å‹ã€‚ä½†åœ¨åç»­çš„å¤æ‚æ•°æ®é›†çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥åŒæ—¶ä¿å­˜ä¼˜åŒ–å™¨çš„é…ç½®ï¼Œä¸€æ˜¯åœ¨è®­ç»ƒä¸å……åˆ†
ä¸ç†æƒ³æ—¶ä¾¿äºæ¥ç»­è®­ç»ƒï¼ŒäºŒæ˜¯å¯ä»¥åæœŸæŸ¥çœ‹å†å²ä¼˜åŒ–å™¨çš„çŠ¶æ€æ¥åˆ†æè®­ç»ƒè¿‡ç¨‹çš„ç°è±¡ã€‚

ä»¥ä¸‹æ˜¯ç¤ºä¾‹ä»£ç å’Œæ–‡ä»¶ç»“æ„ç¤ºä¾‹ï¼š

\begin{lstlisting}
# è®­ç»ƒè¿‡ç¨‹ä¸­ä¿å­˜æ¨¡å‹
æ¯éš”20ä¸ªepoch:
    ä¿å­˜ generator_module çš„å‚æ•°åˆ° checkpoint_dir/generator_epoch{epoch}.pth
    ä¿å­˜ discriminator_module çš„å‚æ•°åˆ° checkpoint_dir/discriminator_epoch{epoch}.pth

# è®­ç»ƒç»“æŸåä¿å­˜æŸå¤±
ä¿å­˜ g_losses å’Œ d_losses åˆ° txt æ–‡ä»¶
ä¿å­˜ g_losses å’Œ d_losses åˆ° csv æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
ç»˜åˆ¶æŸå¤±æ›²çº¿å¹¶ä¿å­˜ä¸º png å›¾ç‰‡

# ç”Ÿæˆå¯è§†åŒ–æ ·æœ¬
for epoch in [20, 40, ..., num_epochs]:
    å¦‚æœå­˜åœ¨ generator_epoch{epoch}.pth æƒé‡æ–‡ä»¶:
        åŠ è½½æƒé‡åˆ° generator
        ç”¨ generator ç”Ÿæˆ100å¼ å›¾ç‰‡
        ä¿å­˜ç”Ÿæˆå›¾ç‰‡åˆ° visual/GAN/gan_sample_epoch_{epoch}.png
\end{lstlisting}

\begin{figure}[htbp]
    \centering
    \begin{minipage}[t]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/visual/111.png}
        \caption{ç¤ºä¾‹å›¾ç‰‡ä¸€ï¼šæ—¥å¿—ç»“æ„}
        \label{fig:img111}
    \end{minipage}
    \hspace{0.04\textwidth}
    \begin{minipage}[t]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/visual/222.png}
        \caption{ç¤ºä¾‹å›¾ç‰‡äºŒï¼šå¯è§†åŒ–ç»“æ„}
        \label{fig:img222}
    \end{minipage}
\end{figure}

\newpage
\subsubsection{æ’å€¼åˆ†æ}
ä¸ºäº†åˆ¤æ–­ç”Ÿæˆå›¾ç‰‡çš„è´¨é‡å’Œå¤šæ ·æ€§ï¼Œå…¶å®æœ‰FIDå’ŒISè¿™ç§æŒ‡æ ‡ï¼Œç”šè‡³å¯ä»¥ç›´æ¥è‚‰çœ¼è§‚å¯Ÿè§†è§‰æ•ˆæœã€‚
ä½†æ›´å½¢è±¡ä¸”æœ‰æ•°ç†ä¾æ®çš„æ–¹æ³•å°±æ˜¯æ’å€¼åˆ†æã€‚å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼ˆä»¥CGANä¸ºä¾‹ï¼‰ï¼Œé€‰å®šä¸¤ç»„ï¼ˆc, zï¼‰å¯¹ï¼Œ
å¹¶åœ¨è¿™ä¸¤å¯¹ä¸­è¿›è¡Œçº¿æ€§ã€çƒé¢æ’å€¼ã€‚ä»¥ä¸‹æ˜¯åœ¨è®­ç»ƒå®Œæˆæ—¶è¿›è¡Œæ’å€¼å¯è§†åŒ–çš„ç»“æœã€‚
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.85\textwidth]{/Users/slkgaw/Proj/GANS/visual/interpolation/res/0_to_1_interp.png}
    \caption{0 åˆ° 1 çš„æ’å€¼}
    \label{fig:interp01}
    \vspace{0.8cm} % é—´éš”
    \includegraphics[width=0.85\textwidth]{/Users/slkgaw/Proj/GANS/visual/interpolation/res/1_to_2_interp.png}
    \caption{1 åˆ° 2 çš„æ’å€¼}
    \label{fig:interp12}
    \vspace{0.8cm} % é—´éš”
    \includegraphics[width=0.85\textwidth]{/Users/slkgaw/Proj/GANS/visual/interpolation/res/2_to_3_interp.png}
    \caption{2 åˆ° 3 çš„æ’å€¼}
    \label{fig:interp23}
    \vspace{0.8cm} % é—´éš”
    \includegraphics[width=0.85\textwidth]{/Users/slkgaw/Proj/GANS/visual/interpolation/res/8_to_9_interp.png}
    \caption{8 åˆ° 9 çš„æ’å€¼}
    \label{fig:interp89}
\end{figure}
ä»æ’å€¼å¯è§†åŒ–çš„ç»“æœå¯ä»¥å‘ç°æ•°å­—åœ¨ç‰¹å¾è¿‡åº¦çš„æ—¶å€™éå¸¸å¹³æ»‘ï¼ŒåŸºæœ¬å¯ä»¥è¯æ˜å„ä¸ªç±»åˆ«çš„æ•°å­—åœ¨ç©ºé—´ä¸­æ˜¯å‡åŒ€ç¦»æ•£åˆ†å¸ƒçš„ã€‚
ä¸ºäº†åšæ¯”è¾ƒï¼Œä»¥ä¸‹å±•ç¤ºè®­ç»ƒä¸å……åˆ†æ—¶çš„æ’å€¼å¯è§†åŒ–ç»“æœï¼Œè¿™å¯ä»¥ä½œä¸ºå„ä¸ªç±»åˆ«åœ¨ç©ºé—´ä¸Šä»æœªè¢«å®Œå…¨åˆ†å¼€çš„è¯æ®ã€‚
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.85\textwidth]{/Users/slkgaw/Proj/GANS/visual/interpolation/test1/4_to_5_interp.png}
    \caption{4 åˆ° 5 çš„æ’å€¼}
    \label{fig:interp45}
    \vspace{0.8cm} % é—´éš”
    \includegraphics[width=0.85\textwidth]{/Users/slkgaw/Proj/GANS/visual/interpolation/test1/5_to_6_interp.png}
    \caption{5 åˆ° 6 çš„æ’å€¼}
    \label{fig:interp56}
    \vspace{0.8cm} % é—´éš”
    \includegraphics[width=0.85\textwidth]{/Users/slkgaw/Proj/GANS/visual/interpolation/test1/6_to_7_interp.png}
    \caption{6 åˆ° 7 çš„æ’å€¼}
    \label{fig:interp67}

\end{figure}

\subsection{å®éªŒç»“æœä¸åˆ†æ}
\subsubsection{GANå’ŒCGAN}
\begin{figure}[htbp]
    \centering
    \begin{minipage}[t]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/visual/GAN/gan_sample_epoch_200.png}
        \caption{GANåœ¨200è½®è®­ç»ƒåçš„ç”Ÿæˆæ•ˆæœ}
    \end{minipage}
    \hspace{0.04\textwidth}
    \begin{minipage}[t]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/visual/CGAN/cgan_sample_epoch_200.png}
        \caption{CGANåœ¨200è½®è®­ç»ƒåçš„ç”Ÿæˆæ•ˆæœ}
    \end{minipage}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/Logs/loss_gan/gan_loss_curve.png}
    \caption{GANæŸå¤±æ›²çº¿}
\end{figure}
\clearpage
\begin{figure}[htbp]
    \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/Logs/loss_cgan/cgan_loss_curve.png}
    \caption{CGANæŸå¤±æ›²çº¿}
\end{figure}

ä»ç”Ÿæˆçš„å›¾ç‰‡æ¥åˆ†æï¼Œå¯ä»¥å‘ç° åœ¨å¤šepoch + å°å­¦ä¹ ç‡ + å­¦ä¹ ç‡scheduleçš„è®­ç»ƒç­–ç•¥ä¸‹ï¼ŒGANå’ŒCGANç”Ÿæˆå›¾ç‰‡çš„ç»“æœåŸºæœ¬ç¬¦åˆé¢„æœŸï¼Œ
å¹¶ä¸”éƒ½å±•ç¤ºäº†ä¸é”™çš„å¤šæ ·æ€§ã€‚
å€¼å¾—æ¢è®¨çš„ä¸€ç‚¹æ˜¯ï¼Œåœ¨æ¨¡å‹å¤§å°ï¼Œè®­ç»ƒç­–ç•¥å·®ä¸å¤šçš„æƒ…å†µä¸‹CGANçš„æ•ˆæœä¼šæ¯”GANçš„æ•ˆæœç¨å¾®å¥½ä¸€äº›ï¼Œå…·ä½“ä½“ç°åœ¨æ•°å­—çš„
ç¬”ç”»æ›´æ¸…æ™°ï¼Œå™ªç‚¹æ›´å°‘ã€‚
è¿™ä¹Ÿæ­£æ˜¯CGANçš„æ„ä¹‰æ‰€åœ¨ï¼ŒCå¸¦æ ‡conditionalï¼ŒCGANä¸ä»…æ˜¯æ”¯æŒæŒ‰ç±»åˆ«ç”Ÿæˆï¼Œæ›´é‡è¦çš„æ˜¯ç±»åˆ«èƒ½å¤ŸçŸ¥é“æ¨¡å‹è¿›è¡Œè®­ç»ƒ
å¹¶çŸ¥é“æ¨¡å‹ç”Ÿæˆã€‚å¯ä»¥ç±»æ¯”äºImproved DDPMä¸­ä½¿ç”¨çš„classifier guidanceï¼Œè¿™é‡Œçš„conditionalç›¸å½“äºæ˜¯ä¸€ä¸ªligthç‰ˆæœ¬çš„
cls guidanceã€‚GANçš„å›¾ç‰‡æœ‰ä¸å°‘å™ªç‚¹çš„åŸå› ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†ç¨‹åº¦æ˜¯ç”±äºç¡®å®ç±»åˆ«æŒ‡å¯¼ï¼Œåœ¨ç”Ÿæˆå›¾åƒè¿‡ç¨‹ä¸­æœ‰äº›æ‹–æ³¥å¸¦æ°´ï¼Œä¼šé™„å¸¦å°éƒ¨åˆ†
å…¶ä»–ç±»åˆ«çš„æ‚ç³…ä¿¡æ¯ã€‚

ä»æŸå¤±æ›²çº¿æ¥çœ‹ï¼ŒGANå’ŒCGANåŸºæœ¬éƒ½åœ¨30ä¸ªepochå°±åœ¨mnistæ•°æ®é›†ä¸Šè¾¾åˆ°äº†æ¯”è¾ƒä¸é”™çš„æ•ˆæœã€‚
å€¼å¾—æ¢è®¨çš„æ˜¯ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨çš„åšå¼ˆå…³ç³»ï¼ŒäºŒè€…çš„lossæ›²çº¿éœ‡è¡çš„æ–¹å‘åŸºæœ¬ç›¸åï¼Œç¬¦åˆâ€œå¯¹æŠ—â€è®­ç»ƒçš„è¿‡ç¨‹ã€‚
è€Œä¸”å› ä¸ºæœ‰äº†ç±»åˆ«æŒ‡å¯¼ï¼ŒCGANçš„æ”¶æ•›æ–¹å‘æ›´å‡†ç¡®ï¼Œæ”¶æ•›é€Ÿåº¦æ›´å¿«ã€‚å¦ä¸€ä¸ªå¯ä»¥æ¢è®¨çš„ç‚¹æ˜¯ï¼Œå°½ç®¡åœ¨ä¸­åæœŸç”Ÿæˆå™¨çš„æŸå¤±æœ‰æ‰€ä¸Šå‡ï¼Œåˆ¤åˆ«å™¨çš„æŸå¤±ä¸‹é™ï¼Œ
ä½†æ˜¯ç”Ÿæˆçš„å›¾ç‰‡çš„è´¨é‡ä¾ç„¶è¿˜åœ¨æœ‰ä¸Šå‡çš„è¶‹åŠ¿ï¼Œè¿™ä¹Ÿæ­£æ˜¯GANçš„æ ¸å¿ƒæ€æƒ³ä¹‹ä¸€ï¼šçº³ä»€å‡è¡¡ã€‚åˆ¤åˆ«å™¨çš„æŸå¤±ä¸‹é™ï¼Œè¡¨ç¤ºåˆ¤åˆ«å™¨å­¦åˆ°äº†æ›´å¥½çš„ç‰¹å¾ï¼Œæœ‰äº†æ›´
ä¸¥æ ¼çš„åˆ¤å®šã€‚å› æ­¤ä¿ƒä½¿ç”Ÿæˆå™¨è¿›ä¸€æ­¥æå‡ã€‚

\vspace{1cm}
å®Œæ•´çš„ç”Ÿæˆå›¾ç‰‡çš„æ ·æœ¬éšepochçš„å˜åŒ–åœ¨é™„å½•


\clearpage
\subsubsection{WGANå’ŒWGAN-GP}

\subsection{å®éªŒç»“æœä¸åˆ†æ}

\begin{figure}[htbp]
    \centering
    \begin{minipage}[t]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/visual/WGAN/Wgan_sample_epoch_200.png}
        \caption{WGANåœ¨200è½®è®­ç»ƒåçš„ç”Ÿæˆæ•ˆæœ}
    \end{minipage}
    \hspace{0.04\textwidth}
    \begin{minipage}[t]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/visual/WGAN-GP/wgan_gp_sample_epoch_200.png}
        \caption{WGAN-GPåœ¨200è½®è®­ç»ƒåçš„ç”Ÿæˆæ•ˆæœ}
    \end{minipage}
\end{figure}

\vspace{1cm}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/Logs/loss_wgan/wgan_loss_curve.png}
    \caption{WGANæŸå¤±æ›²çº¿}
\end{figure}
\clearpage
\begin{figure}[htbp]
    \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/Logs/loss_wgan_gp/wgan_gp_loss_curve.png}
    \caption{WGAN-GPæŸå¤±æ›²çº¿}
\end{figure}

ä»ç”Ÿæˆçš„å›¾ç‰‡æ¥åˆ†æï¼ŒWGANå¹¶æ²¡æœ‰è¾¾åˆ°é¢„æœŸçš„æ•ˆæœï¼Œå°½ç®¡æ¶æ„ç›¸æ¯”è¾ƒæ™®é€šçš„GANæœ‰äº†æ˜æ˜¾çš„æ”¹è¿›ï¼Œä½†æœ€ç»ˆçš„æ•ˆæœå´
ä¸å¦‚æœ´ç´ çš„GANæ¨¡å‹ã€‚åœ¨è§†è§‰æ•ˆæœä¸Šï¼ŒWGANç”Ÿæˆçš„å›¾ç‰‡åŸºæœ¬å¯ä»¥è¯†åˆ«æ•°å­—çš„ç§ç±»ï¼Œä½†æ˜¯æ˜æ˜¾ä¸å¤Ÿæ¸…æ™°ï¼Œä¸”æœ‰è¾ƒå¤šå™ªç‚¹ã€‚
è€ŒWGAN-GPåœ¨ä¿ç•™äº†WGANæ‰€æœ‰ç›¸åŒçš„è®¾å®šçš„æƒ…å†µä¸‹ï¼Œä»…å¼•å…¥äº†æ¢¯åº¦æƒ©ç½šï¼Œå°±èƒ½è§£å†³ä¸Šè¿°é—®é¢˜ã€‚

è€Œä»æŸå¤±æ›²çº¿å’Œwassersteinè·ç¦»æ›²çº¿ä¸éš¾çœ‹å‡ºï¼ŒGPç‰ˆæœ¬ä½¿å¾—è®­ç»ƒç›¸å½“ç¨³å®šã€‚è€Œä¸”æ¯50ä¸ªepochå°±æœ‰ä¸€è½®å¤§å¹…çš„é•¿è¿›ï¼Œ
ä¹Ÿæ°æ°å¯¹åº”äº†æˆ‘é¢„å…ˆè®¾ç½®çš„å­¦ä¹ ç‡scheduleï¼Œä½¿å¾—æ¨¡å‹åœ¨ä¸€ä¸ªé˜¶æ®µå­¦ä¹ å¾—å·®ä¸å¤šåï¼Œèƒ½å¤Ÿåœ¨ä¸‹ä¸ªé˜¶æ®µå­¦ä¹ æ›´æ·±å±‚æ¬¡çš„
ç‰¹å¾ç»†èŠ‚ã€‚

ä»¥ä¸‹å°†ä»å‡ ä¸ªè§’åº¦åˆ†æWGANæœ€ç»ˆæ•ˆæœå·®çš„åŸå› å·²ç»GPèƒ½å¤Ÿæ˜¾è‘—æ”¹è¿›çš„åŸå› ã€‚

æƒé‡è£å‰ªçš„è®¾ç½®ï¼Œæœ¬å®éªŒé‡‡ç”¨äº†WGANåŸè®ºæ–‡çš„æƒé‡è£å‰ªï¼ˆclip\_value=0.01ï¼‰ï¼Œä½†æƒé‡è£å‰ªä¼šå¯¼è‡´Criticçš„è¡¨è¾¾èƒ½åŠ›å—é™ï¼Œå®¹æ˜“å‡ºç°æ¢¯åº¦æ¶ˆå¤±æˆ–æ¨¡å‹å®¹é‡ä¸è¶³ï¼Œè¿›è€Œå½±å“ç”Ÿæˆå™¨çš„è®­ç»ƒæ•ˆæœã€‚

ç½‘ç»œç»“æ„è¾ƒä¸ºç®€å•,Generatorå’ŒCriticå‡ä¸ºå…¨è¿æ¥ç½‘ç»œï¼Œä¸”å±‚æ•°è¾ƒå°‘ï¼Œæ¨¡å‹å®¹é‡æœ‰é™ï¼Œéš¾ä»¥æ•æ‰å¤æ‚çš„æ•°æ®åˆ†å¸ƒã€‚å¯¹äºå›¾åƒç”Ÿæˆä»»åŠ¡ï¼Œå·ç§¯ç»“æ„é€šå¸¸æ›´é€‚åˆï¼Œèƒ½æ›´å¥½åœ°æå–ç©ºé—´ç‰¹å¾ã€‚

ä¼˜åŒ–å™¨é€‰æ‹©ä¸è¶…å‚æ•°ï¼ŒWGANåŸè®ºæ–‡ä½¿ç”¨RMSpropä¼˜åŒ–å™¨ï¼Œä½†æœ¬å®éªŒä¸­ä½¿ç”¨Adamä¹Ÿè®¸ä¸é€‚é…æ¨¡å‹æ¶æ„ã€‚æ­¤å¤–ï¼Œå­¦ä¹ ç‡è®¾ç½®è¿‡äºå¤æ‚ä½†æ˜¯æ¨¡å‹è¿‡äºç®€å•ä¹Ÿæœ‰å¯èƒ½é™ä½å­¦ä¹ æ•ˆç‡ã€‚

GPçš„ä½œç”¨åœ¨äºè®©åˆ¤åˆ«å™¨çš„è¾“å‡ºæ›´åŠ å¹³æ»‘ï¼Œä¸ä¼šå—åˆ°å™ªå£°å·²ç»è¯¯å·®çš„å½±å“è€Œçªç„¶è·³å˜ã€‚
ä»æ›²çº¿ä¸­ä¸éš¾çœ‹å‡ºï¼Œæ™®é€šçš„WGANæ›²çº¿åœ¨åˆæœŸååˆ†é™¡å³­ä¸”éšåæ³¢åŠ¨å¼‚å¸¸ï¼Œå¤§æ¦‚æ˜¯å‡ºç°äº†æ•°å€¼ä¸ç¨³å®šçš„æƒ…å†µï¼Œè¿›è€Œå½±å“äº†åç»­è®­ç»ƒï¼Œä½¿å¾—æ•ˆæœå¤§æ‰“æŠ˜æ‰£ã€‚
æ‰“ä¸ªæ¯”æ–¹ï¼Œå¦‚æœæŠŠåˆ¤åˆ«å™¨æƒ³è±¡æˆä¸€æ¡â€œè¯„åˆ†æ›²çº¿â€ï¼ŒåŸå§‹WGANç”¨â€œæƒé‡è£å‰ªâ€è®©è¿™æ¡æ›²çº¿å˜å¾—å¾ˆâ€œå¹³â€ï¼Œä½†è¿™æ ·å®¹æ˜“è®©åˆ¤åˆ«å™¨å˜â€œç¬¨â€ï¼Œåˆ†ä¸æ¸…å¥½åã€‚
è€ŒGPå°±åƒæ˜¯åœ¨æ›²çº¿ä¸ŠåŠ äº†ä¸€ä¸ªâ€œå¼¹ç°§â€ï¼Œè®©å®ƒæ—¢ä¸ä¼šå¤ªé™¡å³­ï¼ˆé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ï¼‰ï¼Œä¹Ÿä¸ä¼šå¤ªå¹³ï¼ˆä¿ç•™åˆ¤åˆ«èƒ½åŠ›ï¼‰ï¼Œå§‹ç»ˆä¿æŒé€‚åº¦çš„å¼¹æ€§ã€‚è¿™æ ·ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨å°±èƒ½æ›´å¥½åœ°äº’ç›¸å­¦ä¹ ï¼Œç”Ÿæˆæ•ˆæœä¹Ÿä¼šæ›´å¥½ã€‚


\vspace{1cm}
å®Œæ•´çš„ç”Ÿæˆå›¾ç‰‡çš„æ ·æœ¬éšepochçš„å˜åŒ–åœ¨é™„å½•


\newpage
\section{ä»»åŠ¡ä¸‰ï¼šåˆ†æGANåœ¨å¤æ‚æ•°æ®é›†ä¸Šçš„æ€§èƒ½ä¸æ¨¡å¼åå¡Œé—®é¢˜}
\subsection{å®éªŒè®¾ç½®ä¸æ–¹æ³•}
ä»»åŠ¡ä¸‰é‡‡ç”¨äº†BigGANæ¨¡å‹ï¼ŒBigGANæ˜¯googleçš„Deepmindå›¢é˜Ÿåœ¨2019å¹´çš„ä¸€ç¯‡å·¥ä½œï¼Œæ˜¯å½“æ—¶GANç³»åˆ—çš„sotaï¼Œåœ¨FIDå’ŒISä¸¤ä¸ªæŒ‡æ ‡ä¸Šç¢¾å‹å½“æ—¶æ‰€æœ‰çš„æ–¹æ³•ï¼Œ
åŒæ—¶ä¹Ÿè¯æ˜äº†GANå…·æœ‰å¾ˆå¼ºçš„scaleæ€§èƒ½å’Œè¾ƒé«˜çš„ä¸Šé™ã€‚

æœ¬å®éªŒåœ¨ ImageNet-1k å’Œ cifar10 ç­‰ æ•°æ®é›†ä¸Šåšé¢„è®­ç»ƒï¼Œå¹¶åœ¨Animal-Facesä¸Šè¿›è¡Œå¾®è°ƒï¼Œä¸”è®­ç»ƒäº†å¤šä¸ªç‰ˆæœ¬çš„BigGAN,åŒ…æ‹¬æ™®é€šçš„BigGANå’Œconditional-BigGANï¼Œå·²ç»ä¸åŒå›¾ç‰‡sizeçš„ç‰ˆæœ¬ï¼Œæœ‰128x128çš„ç‰ˆæœ¬ä¹Ÿæœ‰512x512çš„ç‰ˆæœ¬ã€‚
æ¨¡å‹å‚æ•°ç”±100Måˆ°1.5Bä¸ç­‰

å®éªŒè®¾å¤‡ä¸º4å¼  Nvidia 4090 24G GPUã€‚

æ­¤å¤–ï¼Œæœ¬å®éªŒæ¢ç©¶äº†å¤§å‚æ•°é‡çš„æ¨¡å‹åœ¨å¤æ‚æ•°æ®ä¸‹çš„æ¨¡å¼å´©æºƒé—®é¢˜ï¼Œä»¥åŠæ¢ç©¶äº†å¦‚ä½•ä½¿ç”¨æˆªæ–­æŠ€å·§æ¥å‡è¡¡æ ·æœ¬çš„è´¨é‡å’Œå¤šæ ·æ€§ã€‚

åœ¨æ¥ä¸‹æ¥å‡ ä¸ªsectionå°†èŠ±å¤§é‡ç¯‡å¹…åˆ†ææ¨¡å‹æ¶æ„ï¼Œè®­ç»ƒtrickå’Œç»“æœåˆ†æã€‚

\newpage
\subsection{æ¨¡å‹æ¶æ„}

ä»¥ä¸‹ä¸ºBigGANç”¨åˆ°çš„æ ¸å¿ƒæ¨¡å—ï¼ˆä»¥128x128çš„conditional-BigGANä¸ºä¾‹ï¼‰ï¼š
\begin{itemize}
    \item å·ç§¯å±‚--conv2dï¼ŒåŒ…æ‹¬1x1çš„ç»´åº¦å˜æ¢å·ç§¯å’Œ3x3çš„ç‰¹å¾æå–å·ç§¯
    \item æ± åŒ–å±‚--Pooling Layersï¼ŒåŒ…æ‹¬å¹³å‡æ± åŒ–å’Œå…¨å±€å¹³å‡æ± åŒ–å’Œ
    \item æ¿€æ´»å‡½æ•°--Activation Functionsï¼ŒåŒ…æ‹¬reluï¼Œtanhå’Œsoftmax
    \item è°±å½’ä¸€åŒ–--Spectral Normalization
    \item æ‰¹é‡å½’ä¸€åŒ–--Batch Normalization
    \item æ¡ä»¶åµŒå…¥å±‚--Embedding Layersï¼ŒåŒ…æ‹¬æ¡ä»¶BatchNormçš„gamma/betaåµŒå…¥å’ŒæŠ•å½±åˆ¤åˆ«å™¨çš„ç±»åˆ«åµŒå…¥
    \item çº¿æ€§å±‚--Linear Layers
    \item è‡ªæ³¨æ„åŠ›æ¨¡å—--Self Attention
    \item æ®‹å·®å—--Residual Blocks
    \item ä¸Šé‡‡æ ·å±‚--Interpolation Layer 
    \item åˆ†å±‚å™ªå£°æ³¨å…¥ï¼Œå°†å™ªå£°zåˆ†å‰²æˆå¤šä¸ªå—ï¼Œåœ¨ä¸åŒåˆ†è¾¨ç‡å±‚æ³¨å…¥ä¸åŒçš„å™ªå£°å—
\end{itemize}

ä»¥ä¸‹æ˜¯æ¨¡å‹çš„æ¶æ„æ€»ç»“ï¼ˆä»¥128x128çš„conditional-BigGANä¸ºä¾‹ï¼‰ï¼š
\vspace{1cm}


ç”Ÿæˆå™¨è·¯å¾„ï¼š

z â†’ Linear â†’ 4Ã—4 â†’ Block1(8Ã—8) â†’ Block2(16Ã—16) 
           â†’ Block3(32Ã—32,Attention) â†’ Block4(64Ã—64,Attention) 
           â†’ Block5(128Ã—128) â†’ BatchNorm â†’ ReLU â†’ Conv â†’ Tanh


\vspace{1cm}
åˆ¤åˆ«å™¨è·¯å¾„ï¼š

128Ã—128 â†’ Block1(64Ã—64) â†’ Block2(32Ã—32,Attention) 
           â†’ Block3(16Ã—16,Attention) â†’ Block4(8Ã—8) â†’ Block5(4Ã—4) 
           â†’ GlobalPool â†’ Linear + Projection

\newpage

\begin{center}
\textbf{è°±å½’ä¸€åŒ–ï¼š}
\end{center}

å¯¹æƒé‡çŸ©é˜µ Wï¼Œè°±å½’ä¸€åŒ–å°†å…¶çº¦æŸä¸ºï¼š
$$W_{SN} = \frac{W}{\sigma(W)}$$

å…¶ä¸­ $\sigma(W)$ æ˜¯ W çš„æœ€å¤§å¥‡å¼‚å€¼ï¼ˆè°±èŒƒæ•°ï¼‰ã€‚

\vspace{0.5cm}

\textbf{ä½œç”¨ï¼š}
ä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢æ·±å±‚æ¬¡çš„å¤§å‚æ•°æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°å€¼ä¸ç¨³å®šé—®é¢˜ï¼Œå¦‚æ¢¯åº¦çˆ†ç‚¸å’Œæ¢¯åº¦æ¶ˆå¤±ã€‚
é™¤æ­¤ä¹‹å¤–ï¼Œè°±å½’ä¸€åŒ–å¯ä»¥çº¦æŸåˆ¤åˆ«å™¨çš„Lipschitzå¸¸æ•°ï¼Œç¨³å®šè®­ç»ƒã€‚
åœ¨æœ¬å®éªŒè®¾ç½®ä¸­ï¼Œè°±å½’ä¸€åŒ–åº”ç”¨äºæ‰€æœ‰çš„å·ç§¯å±‚ã€è‡ªæ³¨æ„åŠ›å±‚å’Œçº¿æ€§å±‚ï¼Œç”¨äºä¿æŒç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›ã€‚


\vspace{1cm}

\begin{center}
    \textbf{æ ‡é‡å½’ä¸€åŒ–ï¼š}
\end{center}
$$BN(x) = \gamma \frac{x - \mu}{\sqrt{\sigma^2 + \epsilon}} + \beta$$

\textbf{ä½œç”¨ï¼š}
æ‰¹é‡å½’ä¸€åŒ–çš„æœ¬æ„æ˜¯æƒ³åŠ é€Ÿè®­ç»ƒé€Ÿåº¦ï¼Œä»æ•°å­¦è§’åº¦è§£é‡ŠBatchNormå¯ä»¥ç¼“è§£å†…éƒ¨åå˜é‡åç§»ã€‚
ä½†æ›´ç›´è§‚ä¸€ç‚¹çš„è¯´æ³•æ˜¯ï¼Œä¸€ä¸ªbatchå†…ä¸åŒçš„é€šé“çš„åˆ†å¸ƒçš„å‡å€¼æ–¹å·®ä¸å°½ç›¸åŒï¼Œä½¿å¾—æ¯è½®è®­ç»ƒéƒ½
ä¼šå› ä¸ºè¿™ç§åˆ†å¸ƒçš„åç§»è€ŒæŠ–åŠ¨éœ‡è¡ã€‚
å› æ­¤BatchNormé€šè¿‡å­¦ä¹ å‡å€¼æ–¹å·®çš„çº¦æŸæ¥æŠŠå„ä¸ªé€šé“çš„åˆ†å¸ƒå°½å¯èƒ½é™åˆ¶åœ¨å·®ä¸å¤šçš„positionæ¥ç¨³å®šè®­ç»ƒã€‚
å› ä¸ºç”¨äº†BatchNormï¼Œå¯¹äºå­¦ä¹ ç‡çš„é€‰æ‹©å¯ä»¥æ›´å¤§èƒ†ä¸€ç‚¹ï¼Œå› ä¸ºBatchNormå¯ä»¥é™åˆ¶é™ä½
æ¨¡å‹å¯¹äºå­¦ä¹ ç‡çš„æ•æ„Ÿåº¦åŒæ—¶å‡å°‘å¯¹æƒé‡åˆå§‹åŒ–çš„ä¾èµ–ã€‚

\vspace{1cm}

\begin{center}
    \textbf{æ¡ä»¶æ‰¹æ ‡å‡†åŒ–ï¼š}
\end{center}
ç»™å®šç±»åˆ«æ ‡ç­¾ $y$ï¼Œæ¡ä»¶BatchNormè®¡ç®—ï¼š
$$CBN(x, y) = \gamma(y) \frac{x - \mu}{\sqrt{\sigma^2 + \epsilon}} + \beta(y)$$

å…¶ä¸­ï¼š
\begin{itemize}
    \item $\gamma(y) = Embedding_{\gamma}(y)$ - ç±»åˆ«ç‰¹å®šçš„ç¼©æ”¾å› å­
    \item $\beta(y) = Embedding_{\beta}(y)$ - ç±»åˆ«ç‰¹å®šçš„åç§»å› å­
    \item æ¯ä¸ªç±»åˆ«éƒ½æœ‰ç‹¬ç«‹çš„å½’ä¸€åŒ–å‚æ•°
\end{itemize}

\textbf{ä½œç”¨ï¼š}
å°†ç±»åˆ«ä¿¡æ¯ç›´æ¥æ³¨å…¥åˆ°ç‰¹å¾å˜æ¢ä¸­ï¼Œå¯ä»¥å…è®¸ä¸åŒç±»åˆ«ä½¿ç”¨ä¸åŒçš„ç‰¹å¾åˆ†å¸ƒã€‚
è¿™æ ·åœ¨ä¿è¯æ¡ä»¶ç”Ÿæˆçš„è´¨é‡å’Œç±»åˆ«ä¸€è‡´æ€§çš„åŒæ—¶ï¼Œä¹Ÿå¹¶æ²¡æœ‰æ¯”ç®€å•æ‹¼æ¥å¤æ‚å¤šå°‘ã€‚



\begin{center}
    \textbf{è‡ªæ³¨æ„åŠ›æ¨¡å—ï¼š}
    \begin{align}
        Q &= Conv_{1 \times 1}(X) \quad \text{(Query)} \\    
        K &= Conv_{1 \times 1}(X) \quad \text{(Key)} \\
        V &= Conv_{1 \times 1}(X) \quad \text{(Value)} \\
        Attention &= Softmax(\frac{QK^T}{\sqrt{d_k}}) \\
        Output &= \gamma \cdot Conv_{1 \times 1}(V \cdot Attention) + X
    \end{align}
\end{center}

å…¶ä¸­ $\gamma$ æ˜¯å¯å­¦ä¹ å‚æ•°ï¼Œåˆå§‹åŒ–ä¸º0ã€‚


\textbf{ä½œç”¨ï¼š}
è‡ªæ³¨æ„åŠ›èƒ½å¤Ÿæ•è·é•¿è·ç¦»ç©ºé—´ä¾èµ–å…³ç³»ï¼Œç›¸æ¯”å·ç§¯æœ‰æ›´çŸ­æœ€è¿œè·ç¦»ã€‚
åœ¨æœ¬å®éªŒæ¨¡å‹æ¶æ„ä¸­ï¼Œè‡ªæ³¨æ„åŠ›æ¨¡å—é€‰æ‹©åœ¨32x32å’Œ64x64è¿™ä¸¤ä¸ªåˆ†è¾¨ç‡æ·»åŠ ï¼Œå¹³è¡¡è®¡ç®—æ•ˆç‡å’Œç»“æœã€‚
è‡ªæ³¨æ„åŠ›çš„æ·»åŠ ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡ç”Ÿæˆå›¾åƒçš„å…¨å±€ä¸€è‡´æ€§ï¼Œç‰¹åˆ«é€‚åˆç”Ÿæˆå…·æœ‰
å¤æ‚ç©ºé—´ç»“æ„çš„å›¾åƒã€‚

\vspace{1cm}

\begin{center}
    \textbf{æ®‹å·®è¿æ¥ï¼š}
\end{center}

\textbf{ç”Ÿæˆå™¨å—ç»“æ„ï¼š}
\begin{align}
h &= ReLU(CBN(x, y)) \\
h &= Upsample(h) \quad \text{(æœ€è¿‘é‚»ä¸Šé‡‡æ ·)} \\
h &= Conv_1(h) \\
h &= ReLU(CBN(h, y)) \\
h &= h + z_{chunk} \quad \text{(å™ªå£°æ³¨å…¥)} \\
h &= Conv_2(h) \\
output &= h + Shortcut(Upsample(x))
\end{align}

\textbf{åˆ¤åˆ«å™¨å—ç»“æ„ï¼š}
\begin{align}
h &= ReLU(BN(x)) \quad \text{(é¢„æ¿€æ´»)} \\
h &= Conv_1(h) \\
h &= ReLU(BN(h)) \\
h &= Conv_2(h) \\
h &= AvgPool(h) \quad \text{(ä¸‹é‡‡æ ·)} \\
output &= h + Shortcut(AvgPool(x))
\end{align}

\textbf{ä½œç”¨ï¼š}
å¤§å¹…è§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œæ”¯æŒæ›´æ·±ç½‘ç»œçš„è®­ç»ƒï¼Œ
è·³è·ƒè¿æ¥ä¿æŒä¿¡æ¯æµåŠ¨ï¼Œé¢„æ¿€æ´»è®¾è®¡æå‡è®­ç»ƒç¨³å®šæ€§ï¼Œå…è®¸ç½‘ç»œå­¦ä¹ æ’ç­‰æ˜ å°„çš„å¾®è°ƒã€‚



\begin{center}
\textbf{æœ€è¿‘é‚»ä¸Šé‡‡æ ·ï¼š}
\end{center}
$$Upsample(x) = Interpolate(x, scale\_factor=2, mode='nearest')$$

\textbf{ä½œç”¨ï¼š}
é€æ­¥å°†4Ã—4ç‰¹å¾å›¾ä¸Šé‡‡æ ·åˆ°128Ã—128ã€‚
æœ€è¿‘é‚»æ’å€¼å¯ä»¥é¿å…å¼•å…¥ä¼ªå½±ï¼Œä¸”ç›¸æ¯”è½¬ç½®å·ç§¯æ›´ç¨³å®šï¼Œå‡å°‘æ£‹ç›˜æ•ˆåº”ã€‚
å…·ä½“çš„ä¸Šé‡‡æ ·è·¯å¾„ä¸ºï¼š4Ã—4 â†’ 8Ã—8 â†’ 16Ã—16 â†’ 32Ã—32 â†’ 64Ã—64 â†’ 128Ã—128

ä½¿ç”¨è¿™ç§é‡‡æ ·æ–¹æ¡ˆå¯ä»¥åœ¨ä¸å¼•å…¥é¢å¤–çš„å¯å­¦ä¹ å‚æ•°çš„å‰æä¸‹å¤§å¹…æé«˜è®¡ç®—æ•ˆç‡ï¼Œ
ä¸”èƒ½é¿å…è½¬ç½®å·ç§¯çš„ä¸å‡åŒ€è¦†ç›–é—®é¢˜å¹¶ä¸åç»­å·ç§¯å±‚é…åˆç”Ÿæˆé«˜è´¨é‡å›¾åƒ

\vspace{1cm}

\begin{center}
    \textbf{åˆ†å±‚å™ªå£°æ³¨å…¥}
\end{center}

\textbf{å™ªå£°åˆ†å‰²ç­–ç•¥ï¼š}
å°†è¾“å…¥å™ªå£° $z \in \mathbb{R}^{128}$ åˆ†å‰²ä¸º5ä¸ªå—ï¼š
$$z = [z_0, z_1, z_2, z_3, z_4]$$
å…¶ä¸­å„å—å¤§å°ä¸º $[26, 26, 26, 25, 25]$

\textbf{æ³¨å…¥ä½ç½®ï¼š}
\begin{itemize}
    \item $z_0$ï¼šä¸ç±»åˆ«åµŒå…¥æ‹¼æ¥ï¼Œè¾“å…¥åˆå§‹çº¿æ€§å±‚
    \item $z_1$ï¼šæ³¨å…¥ç¬¬1ä¸ªç”Ÿæˆå™¨å— (4Ã—4 â†’ 8Ã—8)
    \item $z_2$ï¼šæ³¨å…¥ç¬¬2ä¸ªç”Ÿæˆå™¨å— (8Ã—8 â†’ 16Ã—16)
    \item $z_3$ï¼šæ³¨å…¥ç¬¬3ä¸ªç”Ÿæˆå™¨å— (16Ã—16 â†’ 32Ã—32)
    \item $z_4$ï¼šæ³¨å…¥ç¬¬4ä¸ªç”Ÿæˆå™¨å— (32Ã—32 â†’ 64Ã—64)
\end{itemize}

\textbf{æ³¨å…¥æ–¹å¼ï¼š}
$$h_{new} = h + Linear(z_{chunk}).unsqueeze(-1).unsqueeze(-1)$$

\textbf{ä½œç”¨ï¼š}
ä½¿å¾—ä¸åŒåˆ†è¾¨ç‡å±‚è·å¾—ç‹¬ç«‹çš„éšæœºæ€§è¾“å…¥ï¼Œå¯ä»¥å¯¹ç²—ç²’åº¦ç‰¹å¾ï¼ˆä½åˆ†è¾¨ç‡ï¼‰å’Œç»†ç²’åº¦ç‰¹å¾ï¼ˆé«˜åˆ†è¾¨ç‡ï¼‰åˆ†åˆ«æ§åˆ¶ã€‚
æ­¤å¤–ä»ç»“æœä¸Šåˆ†å±‚æ³¨å…¥å™ªå£°å¯ä»¥æå‡ç”Ÿæˆæ ·æœ¬çš„å¤šæ ·æ€§å’Œè´¨é‡ï¼Œé¿å…æ‰€æœ‰å±‚å…±äº«å•ä¸€å™ªå£°æºçš„dominateç°è±¡ï¼Œå®ç°æ›´ç²¾ç»†çš„ç”Ÿæˆæ§åˆ¶ã€‚

\newpage




\subsection{è®­ç»ƒç»†èŠ‚ä¸è®­ç»ƒæŠ€å·§}

\subsubsection{å­¦ä¹ ç‡schedule}
åŸè®ºæ–‡ä¸­é‡‡å–æ’å®šå­¦ä¹ ç‡+è¶…å¤§batchçš„æ–¹æ¡ˆï¼Œè®¾å¤‡ä¸º8å—google tpu v3ï¼Œç”±äºæœ¬å®éªŒçš„ç¡¬ä»¶é™åˆ¶ï¼Œåªèƒ½æ¢ç”¨è¾ƒå°çš„batchåŠ å¤šepochçš„æ–¹æ¡ˆã€‚
è€Œå¤šepochçš„è®­ç»ƒæœ€æ€•çš„å°±æ˜¯è®­ç»ƒä¸­é€”æŠ–åŠ¨ï¼Œç´¯ç§¯è¯¯å·®å½±å“æœ€ç»ˆç»“æœã€‚æ‰€ä»¥åœ¨æœ¬å®éªŒä¸­é‡‡ç”¨äº†æ¯”è¾ƒä¿å®ˆçš„å­¦ä¹ ç‡ç­–ç•¥--ä½™å¼¦é€€ç«+warmupã€‚
åœ¨è®­ç»ƒåˆæœŸå­¦ä¹ ç‡ä»0çº¿æ€§å¢åŠ åˆ°åˆå§‹å­¦ä¹ ç‡ï¼ŒæŒç»­åˆ°warmup\_stepsæ­¥ï¼Œé¿å…åˆæœŸè®­ç»ƒæ¢¯åº¦ä¸ç¨³å®šã€‚
è€Œåœ¨warmupåï¼Œå­¦ä¹ ç‡ä¼šæŒ‰ç…§ä½™å¼¦å‡½æ•°ç¼“æ…¢ä¸‹é™ï¼Œæœ€ç»ˆè¶‹äº0ã€‚

å…³äºå­¦ä¹ ç‡é€‰æ‹©çš„ä¸€ä¸ªè§£é‡Šæ˜¯ï¼šå› ä¸º128x128æˆ–512x512çš„å›¾ç‰‡éå¸¸å æ˜¾å­˜ï¼Œå› æ­¤batché€‰ç”¨å¾ˆå°ã€‚ä½†æ˜¯ImageNetæ•°æ®é›†æœ¬èº«çš„å¤šæ ·æ€§è¿˜æ˜¯ä¸é”™çš„ã€‚
æ‰€ä»¥åœ¨batchæ¯”è¾ƒå°çš„æƒ…å†µä¸‹ï¼Œå™ªå£°å’Œéšæœºæ€§çš„å½±å“æ¯”ä¾‹ä¼šæ¯”è¾ƒå¤§ï¼Œå¦‚æœæ­¤æ—¶ä¿æŒå’ŒåŸè®ºæ–‡ä¸­çš„å­¦ä¹ ç‡è®¾ç½®ï¼Œé‚£ä¹ˆä¼šæ”¾å¤§ç´¯ç§¯è¯¯å·®ã€‚
å› æ­¤é‡‡ç”¨å¦‚æ­¤ä¿å®ˆçš„å­¦ä¹ ç‡ç­–ç•¥ã€‚

\vspace{0.5cm}
\noindent\textbf{scheduleå‡½æ•°å®ç°ï¼š}
\begin{lstlisting}[language=Python]
# 1. å®šä¹‰ schedule å‡½æ•°
def get_biggan_lr_lambda(warmup_steps, total_steps):
    def lr_lambda(step):
        if step < warmup_steps:
            return step / float(warmup_steps)
        else:
            progress = (step - warmup_steps) / float(max(1, total_steps - warmup_steps))
            return 0.5 * (1.0 + np.cos(np.pi * progress))
    return lr_lambda
\end{lstlisting}
\vspace{0.5cm}
\noindent\textbf{è®­ç»ƒä¸­çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š}
\begin{lstlisting}[language=Python]
# 2. åˆå§‹åŒ– scheduler
lr_lambda_func = get_biggan_lr_lambda(warmup_steps, total_steps)
scheduler_g = LambdaLR(optimizer_g, lr_lambda_func)
scheduler_d = LambdaLR(optimizer_d, lr_lambda_func)

# 3. åœ¨è®­ç»ƒå¾ªç¯ä¸­æ¯æ­¥è°ƒç”¨ step() æ›´æ–°å­¦ä¹ ç‡
for epoch in range(num_epochs):
    for i, (images, labels) in enumerate(dataloader):
        # ...è®­ç»ƒåˆ¤åˆ«å™¨å’Œç”Ÿæˆå™¨...
        scheduler_g.step()
        scheduler_d.step()
        # ...å…¶ä½™è®­ç»ƒä»£ç ...
# ...å‰©ä½™ä»£ç ...
\end{lstlisting}

\subsubsection{Hinge Loss}
åœ¨BigGANåŸè®ºæ–‡ä¸­ä½¿ç”¨äº†Hinge Lossè¿™ä¸€æŸå¤±å‡½æ•°ï¼Œå…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š
\begin{itemize}
    \item å¯¹äºåˆ¤åˆ«å™¨ï¼ŒHinge Loss æ—¨åœ¨è®©çœŸå®æ ·æœ¬çš„è¾“å‡ºå¤§äº1ï¼Œç”Ÿæˆæ ·æœ¬çš„è¾“å‡ºå°äº-1ï¼Œä»è€Œæ‹‰å¼€ä¸¤è€…çš„åˆ†ç•Œã€‚
    \item å¯¹äºç”Ÿæˆå™¨ï¼ŒHinge Loss ç›®æ ‡æ˜¯æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¾“å‡ºï¼ˆå³è®©åˆ¤åˆ«å™¨è®¤ä¸ºç”Ÿæˆæ ·æœ¬æ›´â€œçœŸå®â€ï¼‰ã€‚
\end{itemize}

å®éªŒè¡¨æ˜ï¼ŒHinge loss è¿™ç§æŸå¤±å‡½æ•°èƒ½è®©GANè®­ç»ƒæ›´ç¨³å®šã€ç”Ÿæˆæ•ˆæœæ›´å¥½ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹åŸå› ï¼š
1. å¯¹åˆ¤åˆ«å™¨è¾“å‡ºçš„é™åˆ¶æ›´æ˜ç¡® 2. æ¢¯åº¦æ›´å¹³æ»‘ï¼Œè®­ç»ƒæ›´ç¨³å®š 3.è®©ç”Ÿæˆå™¨æœ‰æ›´æ˜ç¡®çš„ç›®æ ‡ 4.é™ä½æ¢¯åº¦æ¶ˆå¤±é£é™©


\noindent\textbf{Hinge\_Lossä»£ç å®ç°å¦‚ä¸‹ï¼š}
\begin{lstlisting}[language=Python]
def hinge_g_loss(fake_scores):
    # ç”Ÿæˆå™¨çš„ Hinge Loss
    # ç›®æ ‡ï¼šæœ€å¤§åŒ– D(G(z))ï¼Œç­‰ä»·äºæœ€å°åŒ– -D(G(z))
    return -torch.mean(fake_scores)

def hinge_d_loss(real_scores, fake_scores):
    # åˆ¤åˆ«å™¨çš„ Hinge Loss
    # æŸå¤±å½¢å¼ï¼šmax(0, 1-D(real)) + max(0, 1+D(fake))
    real_loss = torch.mean(F.relu(1.0 - real_scores))
    fake_loss = torch.mean(F.relu(1.0 + fake_scores))
    return real_loss + fake_loss
\end{lstlisting}
\vspace{0.5cm}
\noindent\textbf{è®­ç»ƒä¸­çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š}
\begin{lstlisting}[language=Python]
for epoch in range(num_epochs):
    for i, (images, labels) in enumerate(dataloader):
        # åˆ¤åˆ«å™¨è®­ç»ƒ
        real_scores = D(x_real, y)
        fake_scores = D(G(z, y), y).detach()
        d_loss = mean(max(0, 1 - real_scores)) + mean(max(0, 1 + fake_scores))
        d_loss.backward()
        optimizer_d.step()

        # ç”Ÿæˆå™¨è®­ç»ƒ
        fake_scores = D(G(z, y), y)
        g_loss = -mean(fake_scores)
        g_loss.backward()
        optimizer_g.step()
\end{lstlisting}  

\subsubsection{æ­£äº¤æ­£åˆ™åŒ–}
æ­£äº¤æ­£åˆ™åŒ–æ˜¯ä¸€ç§å¯¹æƒé‡çŸ©é˜µæ–½åŠ çº¦æŸçš„æ–¹æ³•ï¼Œç›®çš„æ˜¯è®©æƒé‡çŸ©é˜µçš„ä¸åŒåˆ—
ä¹‹é—´å°½å¯èƒ½ä¿æŒæ­£äº¤ï¼ˆå³å†…ç§¯æ¥è¿‘0ï¼‰ã€‚è¿™æ ·åšå¯ä»¥é¿å…ç‰¹å¾å†—ä½™ï¼Œæé«˜ç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›å’Œç¨³å®šæ€§ã€‚
è€ŒåŸè®ºæ–‡ä¸­åˆ™ä½¿ç”¨äº†æ”¹è¿›ç‰ˆæœ¬ï¼ˆä¸‹æ–¹ç¬¬äºŒä¸ªç‰ˆæœ¬ï¼‰ï¼Œæœ¬å®éªŒæœªä½¿ç”¨ã€‚å…¬å¼å¦‚ä¸‹ï¼š
$$ \mathcal{L}{ortho} = \beta \sum{l} \left| W_l^\top W_l - I \right|_F^2 $$
$$ R_\beta(W) = \beta \left| W^\top W \odot (1 - I) \right|_F^2 $$
\begin{itemize}
    \item $W_l$ è¡¨ç¤ºç¬¬ $l$ å±‚çš„æƒé‡çŸ©é˜µï¼ˆé€šå¸¸ä¸ºå…¨è¿æ¥æˆ–å·ç§¯å±‚çš„æƒé‡ï¼Œå±•å¹³æˆäºŒç»´çŸ©é˜µï¼‰
    \item $I$ æ˜¯å•ä½çŸ©é˜µï¼Œ\odot è¡¨ç¤ºé˜¿è¾¾é©¬ç§¯
    \item $|\cdot|_F$ è¡¨ç¤ºFrobeniusèŒƒæ•°
    \item $\beta$ æ˜¯æ­£äº¤æ­£åˆ™åŒ–çš„æƒé‡ç³»æ•°
\end{itemize}

\noindent\textbf{æ­£äº¤æ­£åˆ™åŒ–ä»£ç å®ç°å¦‚ä¸‹ï¼š}
\begin{lstlisting}[language=Python]
def orthogonal_regularization(model, beta=1e-4):
    ortho_loss = 0.0
    for name, param in model.named_parameters():
        if 'weight' in name and param.dim() == 2:
            # paramçš„å½¢çŠ¶æ˜¯ (out_features, in_features)
            W = param
            WT_W = torch.matmul(W.t(), W)
            I = torch.eye(WT_W.size(0), device=W.device, dtype=W.dtype)
            ortho_loss += ((WT_W - I)**2).sum()
    return beta * ortho_loss

for epoch in range(num_epochs):
    for i, (images, labels) in enumerate(dataloader):
        # åˆ¤åˆ«å™¨è®­ç»ƒ
        d_loss_ortho = orthogonal_regularization(discriminator)
        d_loss_total = d_loss_hinge + d_loss_ortho

        # å…¶ä»–ä»£ç 

        # ç”Ÿæˆå™¨è®­ç»ƒ
        g_loss_ortho = orthogonal_regularization(generator)
        g_loss_total = g_loss_hinge + g_loss_ortho
        # å…¶ä»–ä»£ç 
\end{lstlisting}  


\subsubsection{å‚æ•°å¹³å‡}
EMAï¼ˆExponential Moving Averageï¼ŒæŒ‡æ•°æ»‘åŠ¨å¹³å‡ï¼‰åœ¨GANç³»åˆ—æ¨¡å‹çš„è®­ç»ƒä¸­çš„ä¸»è¦ä½œç”¨æ˜¯æå‡ç”Ÿæˆå™¨çš„ç¨³å®šæ€§å’Œç”Ÿæˆè´¨é‡ã€‚
å…·ä½“çš„åšæ³•æ˜¯å…ˆç”¨åˆå§‹çš„ç”Ÿæˆå™¨çŠ¶æ€æ¥åˆå§‹åŒ–EMAç”Ÿæˆå™¨ï¼Œç„¶åæ¯ä¸ªepochè®­ç»ƒç»“æŸåï¼Œç”¨å°æƒé‡ç³»æ•°å°†ç”Ÿæˆå™¨çš„å‚æ•°åŠ æƒåˆ°
EMAç”Ÿæˆå™¨ä¸­ï¼Œä½¿å¾—EMAç”Ÿæˆå™¨ç¼“æ…¢æ›´æ–°ã€‚

è¿™ç§æ›´æ–°ç­–ç•¥ååˆ†æœ‰åŠ©äºå‡å¼±è®­ç»ƒè¿‡ç¨‹ä¸­çš„å™ªå£°å’Œéœ‡è¡ï¼Œä½¿å‚æ•°å˜åŒ–æ›´åŠ å¹³æ»‘ã€‚
ç»å®éªŒè¯æ˜ï¼Œåœ¨è®­ç»ƒåæœŸï¼Œç›´æ¥ç”¨EMAç”Ÿæˆå™¨ç”Ÿæˆçš„æ ·æœ¬é€šå¸¸æ¯”æ™®é€šç”Ÿæˆå™¨æ›´æ¸…æ™°ã€æ›´ç¨³å®šï¼ŒFID/ISç­‰æŒ‡æ ‡æ›´å¥½ã€‚

æ­¤å¤–ï¼ŒEMAèƒ½ç¼“è§£æ¨¡å‹åœ¨è®­ç»ƒåæœŸçš„è¿‡æ‹Ÿåˆå’Œæ¨¡å¼å´©æºƒé—®é¢˜ï¼Œä½¿ç”Ÿæˆå™¨ä¿æŒæ›´å¥½çš„æ³›åŒ–èƒ½åŠ›ã€‚
å› æ­¤ï¼Œè¯„ä¼°æ—¶å¸¸ç”¨EMAç”Ÿæˆå™¨è€Œéå½“å‰ç”Ÿæˆå™¨ï¼Œå¾—åˆ°çš„åˆ†æ•°æ›´èƒ½åæ˜ æ¨¡å‹çš„çœŸå®æ€§èƒ½ã€‚

EMAçš„æŠ€å·§è¦æƒ³è¾¾åˆ°å¥½çš„æ•ˆæœçš„å‰ææ˜¯EMAçš„alphaå‚æ•°è®¾ç½®ï¼Œè®¾ç½®è¿‡å¤§å®¹æ˜“å¯¼è‡´å­¦å¾—å¤ªæµ…ï¼Œå­¦ä¹ ä¸åˆ°ç”Ÿäº§å›¾ç‰‡çš„åˆ†å¸ƒï¼Œ
å¦‚æœalphaè®¾ç½®è¿‡å¤§ï¼Œåœ¨è®­ç»ƒåæœŸå°±å¾ˆæœ‰å¯èƒ½å’Œæ™®é€šç”Ÿæˆå™¨ä¸€æ ·ï¼Œç”šè‡³ä¼šè¿‡æ‹Ÿåˆæ•°æ®ã€‚
å› æ­¤å®é™…çš„alphaé€‰æ‹©éœ€è¦æ ¹æ®æ¨¡å‹è§„æ¨¡å’Œè®­ç»ƒè§„æ¨¡æ¥å†³å®šã€‚

\vspace{1cm}

\begin{lstlisting}[language=python]
# åˆå§‹åŒ–EMAç”Ÿæˆå™¨
ema_generator = copy(generator)

for each training step:
    # ...è®­ç»ƒç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨...
    # EMAå‚æ•°æ›´æ–°
    for ema_param, param in zip(ema_generator.parameters(), generator.parameters()):
        ema_param = alpha * ema_param + (1 - alpha) * param

for each evaluation:
    # ç”¨æ™®é€šç”Ÿæˆå™¨ç”Ÿæˆæ ·æœ¬ï¼Œè®¡ç®—æŒ‡æ ‡
    samples = generator.generate(...)
    IS, FID = evaluate(samples)
    # ç”¨EMAç”Ÿæˆå™¨ç”Ÿæˆæ ·æœ¬ï¼Œè®¡ç®—æŒ‡æ ‡
    ema_samples = ema_generator.generate(...)
    EMA_IS, EMA_FID = evaluate(ema_samples)
\end{lstlisting}

\vspace{1cm}
åœ¨checkpointsä¿å­˜åˆ°æ—¶å€™è¦æŠŠema\_generatoråŒ…æ‹¬è¿›å»ï¼ŒåŒæ—¶ä¿è¯ema\_generatorä¿æŒevalæ¨¡å¼ï¼Œ
é¿å…è®¡ç®—æ¢¯åº¦ä»è€Œå‡ºç°å‚æ•°æ›´æ–°é”™è¯¯ã€‚

\subsubsection{å¤šå¡è®­ç»ƒçš„ç­–ç•¥trick}

ä¸ºäº†åŠ é€Ÿè®­ç»ƒï¼Œå¤šå¡è®­ç»ƒåœ¨å¦‚ä»Šçš„æ·±åº¦å­¦ä¹ ä¸­å·²ç»å˜å¾—ååˆ†å¸¸è§ï¼Œä¸”ååˆ†å¿…è¦ã€‚ä»è®­ç»ƒæ•ˆæœä¸Šæ¥è®²ï¼Œå¤šå¡è®­ç»ƒå…è®¸è®­ç»ƒæ—¶å€™ä½¿ç”¨æ›´å¤§çš„batchï¼Œ
è€Œæ›´å¤§çš„batchèƒ½æ˜¾è‘—å‡å°‘å™ªéŸ³å’Œè¯¯å·®å¸¦æ¥çš„å¹²æ‰°ï¼Œå°¤å…¶æ˜¯åœ¨GANè¿™ç§è®­ç»ƒæ•æ„Ÿçš„æ¨¡å‹ä¸Šï¼Œèƒ½å¤Ÿæœ‰æ•ˆç¨³å®šè®­ç»ƒè¿‡ç¨‹ã€‚

ä¸ºäº†æ¨¡ä»¿åŸè®ºæ–‡ä¸­çš„è¶…å¤§batchï¼Œæœ‰ä¸€ä¸ªå°trickæ˜¯ç´¯ç§¯æ¢¯åº¦æ³•ï¼Œå³æ¯stepæ­¥åšä¸€æ¬¡åå‘ï¼Œå…¶ä½™æ—¶åˆ»åªç´¯ç§¯æ¢¯åº¦ï¼Œä¼˜åŒ–å™¨ä¸åšä¼˜åŒ–ã€‚
ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š
\begin{lstlisting}[language=python]
# 1. æ„å»ºæ¨¡å‹
generator = Generator(...)
discriminator = Discriminator(...)

# 2. å¤šå¡åŒ…è£…
if GPUæ•°é‡ > 1:
    generator = DataParallel(generator)
    discriminator = DataParallel(discriminator)

# 3. ä¼˜åŒ–å™¨å’Œç´¯è®¡æ­¥æ•°
optimizer_g = Adam(generator.parameters(), ...)
optimizer_d = Adam(discriminator.parameters(), ...)
accumulation_steps = 4  # ä¾‹å¦‚4ä¸ªå°batchç­‰ä»·äº1ä¸ªå¤§batch

# 4. è®­ç»ƒå¾ªç¯
for epoch in range(num_epochs):
    optimizer_g.zero_grad()
    optimizer_d.zero_grad()
    for i, (images, labels) in enumerate(dataloader):
        # åˆ¤åˆ«å™¨è®­ç»ƒ
        d_loss = compute_d_loss(real_scores, fake_scores) / accumulation_steps
        d_loss.backward()
        if (i + 1) % accumulation_steps == 0:
            optimizer_d.step()
            optimizer_d.zero_grad()

        # ç”Ÿæˆå™¨è®­ç»ƒ
        g_loss = compute_g_loss(fake_scores) / accumulation_steps
        g_loss.backward()
        if (i + 1) % accumulation_steps == 0:
            optimizer_g.step()
            optimizer_g.zero_grad()
\end{lstlisting}

\newpage
\subsection{å®éªŒç»“æœä¸åˆ†æ}
\subsubsection{æ ·æœ¬åˆ†æ}
æ€»çš„æ¥è¯´æœ¬å®éªŒè®­ç»ƒçš„BigGANæ¨¡å‹åœ¨ImageNetä¸Šé¢„è®­ç»ƒçš„æ•ˆæœæ¯”è¾ƒå¥½ï¼Œä½†æ˜¯åœ¨AnimalFacesä¸Šå¾®è°ƒçš„æ•ˆæœä¸å°½äººæ„ï¼ˆåœ¨åé¢å±€é™æ€§é‚£ä¸€èŠ‚æœ‰æåˆ°ï¼‰ã€‚
ä¸‹å›¾å‡ä¸ºImageNetçš„ç”Ÿæˆç»“æœã€‚ä»¥ä¸‹å›¾ç‰‡ç±»åˆ«åˆ†åˆ«ä¸ºwolfï¼Œhamburgerï¼Œtruckï¼Œdaisyï¼Œéšæœºã€‚
\vspace{1cm}


\begin{figure}[htbp]
    \centering
    \includegraphics[width=1.0\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/128_by_class/19.jpg}
    \caption{æŒ‰ç±»åˆ«ç”Ÿæˆï¼ˆwolfï¼‰}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=1.0\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/128_by_class/34.jpg}
    \caption{æŒ‰ç±»åˆ«ç”Ÿæˆï¼ˆhamburgerï¼‰}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=1.0\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/128_by_class/52.jpg}
    \caption{æŒ‰ç±»åˆ«ç”Ÿæˆï¼ˆtrunkï¼‰}
\end{figure}
\newpage
\begin{figure}[htbp]
    \centering
    \includegraphics[width=1.0\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/128_by_class/53.jpg}
    \caption{æŒ‰ç±»åˆ«ç”Ÿæˆï¼ˆdaisyï¼‰}
\end{figure}


\foreach \i in {1} {
    \begin{figure}[htbp]
        \centering
        \includegraphics[width=1.0\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/128_random/\i.jpg}
        \caption{éšæœºç”Ÿæˆ}
    \end{figure}
}

\vspace{1cm}
ä»ç”Ÿæˆå›¾ç‰‡çš„æ•ˆæœä¸Šæ¥çœ‹ï¼ŒBigGANå› ä¸ºå±äºGANç³»åˆ—æ¨¡å‹ï¼Œåœ¨ç”Ÿæˆè´¨é‡è¿™ä¸€æ–¹é¢ååˆ†å¼ºåŠ²ï¼Œåœ¨éƒ¨åˆ†ç”Ÿæˆæ ·æœ¬ä¸­ä¿æŒäº†å’Œæ•°æ®é›†
æ¥è¿‘çš„ä¿çœŸåº¦ã€‚ä½†ä¸æ­¤åŒæ—¶ï¼Œæ¨¡å‹ç”Ÿæˆå›¾ç‰‡çš„å¤šæ ·æ€§å¹¶ä¸ç®—å¥½ï¼ˆåœ¨å±€é™æ€§å°èŠ‚ä¼šè¯¦ç»†è¯´æ˜ï¼‰ï¼Œå°±æ¯”å¦‚é›èŠè¿™ä¸ªç±»åˆ«ç”Ÿæˆçš„æ ·æœ¬åŸºæœ¬éƒ½å¾ˆç›¸ä¼¼ã€‚

\newpage

\subsubsection{Truncation Trick}
åŸè®ºæ–‡ä¸­æåŠäº†ä¸€ä¸ªååˆ†æœ‰ç”¨çš„æŠ€å·§ï¼Œå«åštruncation trickï¼Œå³åœ¨ç”Ÿæˆéšæœºé«˜æ–¯å™ªå£°æ—¶ï¼Œé™å®šå™ªå£°çš„ç©ºé—´èŒƒå›´ï¼Œåªå…è®¸é«˜æ¦‚ç‡ç©ºé—´ä¸­çš„å™ªå£°ç”¨äºå›¾ç‰‡ç”Ÿæˆã€‚
è¿™æ ·èƒ½å¤Ÿå¤§å¹…æé«˜å›¾æ ‡è´¨é‡ä½†åŒæ—¶ä¹Ÿä¼šå¤§å¹…é™ä½ç”Ÿæˆå›¾ç‰‡çš„å¤šæ ·æ€§ã€‚ä»¥ä¸‹å±•ç¤ºä¸åŒæˆªæ–­å€¼ç”Ÿæˆçš„å›¾ç‰‡æ•ˆæœã€‚

\foreach \i in {0.2, 0.4, 0.6, 0.8, 1.0}{
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.9\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/truncation/trunc_\i/cat.jpg}
        \caption{trunc=\i}
    \end{figure}
    \par\vspace{0cm}
}


Truncationçš„ä¼ªä»£ç å¦‚ä¸‹ï¼š
\begin{lstlisting}[language=python]
# é‡‡æ ·é«˜æ–¯å™ªå£°
z = np.random.randn(batch_size, z_dim)
# æˆªæ–­
truncation = 0.5
z_t = np.clip(z, mean - truncation * std, mean + truncation * std)
  
\end{lstlisting}

\subsubsection{æ’å€¼åˆ†æ}
åˆ¤æ–­GANç³»åˆ—æ¨¡å‹ç”Ÿæˆè´¨é‡çš„ä¸€ä¸ªåšæ³•æ˜¯å¯¹ç»™å®šçš„ä¸¤ç»„(z, c)å¯¹ï¼ˆzä¸ºå™ªå£°ï¼Œcä¸ºç±»åˆ«ï¼‰ï¼Œé€šè¿‡çƒé¢çº¿æ€§æ’å€¼ï¼Œæ¥è·å¾—å¤šç»„(z, c)å¯¹ã€‚
ç„¶åä»¥æ­¤é€å…¥ç”Ÿæˆå™¨è¿›è¡Œç”Ÿæˆï¼Œé€šè¿‡è§‚å¯Ÿä¸€ç³»åˆ—æ ·æœ¬çš„ç‰¹å¾è¿ç»­æ€§æ¥åˆ¤æ–­æ¨¡å‹åœ¨æ‹Ÿåˆå„ä¸ªç±»åˆ«åˆ†å¸ƒæ—¶çš„å®é™…æ•ˆæœã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œå¯¹äºç›¸ä¼¼çš„ç±»åˆ«ï¼Œæ¯”å¦‚åŒæ˜¯åŠ¨ç‰©ï¼Œæˆ–è€…ç›¸ä¼¼çš„ç±»åˆ«è¯­å¢ƒï¼Œæ¯”å¦‚é¸Ÿå’Œæœå®éƒ½åœ¨æ ‘ä¸Šï¼Œç‰¹å¾å˜åŒ–åº”å½“è¡¨ç°çš„å‡åŒ€ï¼Œè¿‡åº¦å¹³æ»‘ï¼Œå¦‚æ­¤ä¾¿å¯åŸºæœ¬å¯ä»¥ç¡®å®šç±»åˆ«é—´åˆ†å¸ƒåœ¨éšç©ºé—´çš„åŒä¸€ä¸ªè¶…çƒé¢ä¸Šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

\vspace{0.5cm}

\foreach \i in {1,2,3,4,16,14,39}{
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.9\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/interpolation/\i.png}
    \end{figure}
}

\newpage

\subsubsection{å±€é™æ€§}

æœ¬å®éªŒå°½ç®¡åœ¨ImageNetä¸Šè¡¨ç°è‰¯å¥½ï¼Œä½†æ˜¯åœ¨å¾®è°ƒçš„æ—¶å€™å‡ºç°äº†ä¸¥é‡çš„æ¨¡å¼åå¡Œé—®é¢˜ã€‚æ— è®ºåœ¨è®­ç»ƒçš„ä»€ä¹ˆé˜¶æ®µç”Ÿæˆçš„å›¾ç‰‡åŸºæœ¬åªæœ‰1-2ç§ç›¸ä¼¼æ¨¡å¼ï¼Œå¯ä»¥è¯´åŸºæœ¬æ˜¯è¿‡æ‹Ÿåˆåˆ°
æŸä¸€æ˜¾è‘—çš„å›¾ç‰‡æ¨¡å¼ä¸Šäº†ã€‚åˆæ­¥åˆ†æåŸå› ï¼Œæ•°æ®é›†çš„å·®å¼‚æ˜¯é€ æˆè¿™ä¸€ç»“æœçš„ä¸»è¦å› ç´ ã€‚

AnimalFacesæ•°æ®é›†ï¼ˆè§é™„å½•ï¼‰åŒ…å«åŠ¨ç‰©é¢éƒ¨çš„512x512çš„å›¾ç‰‡ï¼Œåªæœ‰ä¸‰ä¸ªç±»ï¼Œåˆ†åˆ«æ˜¯catï¼Œdogå’Œwildï¼Œä½†æ˜¯æ¯ä¸ªç±»çš„å¤šæ ·æ€§éå¸¸å¥½ã€‚
å½¢è±¡åœ°è¯´ï¼Œä¸€ä¸ªç±»åˆ«çš„åˆ†å¸ƒååˆ†ä¸å¥½å»ºæ¨¡ï¼Œæ¯”å¦‚ç‹—ğŸ¶æœ‰éå¸¸å¤šçš„å“ç§ï¼Œé‡‘æ¯›çŠ¬ï¼Œæ¾ç‹®ï¼Œè…Šè‚ çŠ¬ï¼Œé•¿ç›¸éƒ½ååˆ†ä¸ä¸€æ ·ã€‚
è€Œæœ¬å®éªŒé¢„è®­ç»ƒæ—¶æ‰€ç”¨çš„ImageNetå¯¹è¿™ç§åŒºåˆ«å¾ˆå¤§çš„ä¸åŒå“ç§çš„ç‹—å…¶å®æ˜¯ç®—åˆ†ä¸ºä¸åŒçš„ç±»åˆ«ã€‚
\textbf{åŒæ—¶è¿™ä¹Ÿå†ä¸€æ¬¡è¯å®äº†GANç³»åˆ—æ¨¡å‹çš„ç¼ºç‚¹ï¼Œå¤šæ ·æ€§ä¸è¶³ï¼Œå®¹æ˜“å‡ºç°æ¨¡å¼åå¡Œç°è±¡ã€‚
å› æ­¤GANæ¨¡å‹ä¸èƒ½åƒdiffusionæ¨¡å‹é‚£æ ·ç”¨textåšç»†ç²’åº¦çš„æ§åˆ¶ï¼Œè€Œä¸”GANæ¨¡å‹åœ¨è¯­å¢ƒç»†èŠ‚å¾ˆå¤šçš„ç±»åˆ«çš„æƒ…å†µä¸‹çš„ç”Ÿæˆæ•ˆæœéå¸¸å·®ã€‚
}
ä»å¾®è°ƒæ›²çº¿ä¸Šäº¦å¯çœ‹å‡ºBigGANæ¨¡å‹åœ¨AnimalFacesæ•°æ®é›†ä¸Šè®­ç»ƒååˆ†ä¸ç¨³å®šï¼Œå°½ç®¡ç”¨äº†å¾ˆå¤§batchï¼Œæ¨¡å‹ä¼˜åŒ–çš„æ–¹å‘ä¾ç„¶é£˜æ‘‡ä¸å®šï¼Œåå¤éœ‡è¡ã€‚
å¾®è°ƒç»“æœå’Œå¾®è°ƒæŸå¤±å¦‚ä¸‹ï¼š

\begin{figure}[H]
    \centering
    \foreach \i in {1,3,2}{
        \begin{minipage}[t]{0.3\textwidth}
            \centering
            \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/cat/group3/sample_\i.png}
        \end{minipage}
    }
    \caption{å¾®è°ƒåï¼Œæ¨¡å‹åŸºæœ¬åªèƒ½ç”Ÿæˆè¿™ä¸‰å¼ æ ·è²Œçš„çŒ«ï¼Œè€Œä¸”ç›¸ä¼¼åº¦å¾ˆé«˜}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/loss_curves.png}
    \caption{BigGANåœ¨AnimalFacesæ•°æ®é›†ä¸Šå¾®è°ƒçš„æŸå¤±æ›²çº¿}
\end{figure}

















\newpage
\section{é™„å½•}


% ===== GAN ç»“æœå±•ç¤º =====
\subsection{GANä¸åŒepochç”Ÿæˆçš„æ ·æœ¬}
\vspace{1.5cm}
\begin{figure}[htbp]
    \centering
    \foreach \i/\ep in {1/20,2/40,3/60,4/80,5/100,6/120,7/140,8/160,9/180,10/200} {
        \begin{minipage}[t]{0.23\textwidth}
            \centering
            \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/visual/GAN/gan_sample_epoch_\ep.png}
            \caption*{GAN \ep~epoch}
        \end{minipage}
        \ifnum\i=4 \par\vspace{0.2cm}\fi
        \ifnum\i=8 \par\vspace{0.2cm}\fi
    }
    \caption{GANä¸åŒepochç”Ÿæˆæ ·æœ¬}
    \label{fig:gan_epochs}
\end{figure}


\newpage

% ===== CGAN ç»“æœå±•ç¤º =====
\subsection{CGANä¸åŒepochç”Ÿæˆçš„æ ·æœ¬}
\vspace{1.5cm}
\begin{figure}[htbp]
    \centering
    \foreach \i/\ep in {1/20,2/40,3/60,4/80,5/100,6/120,7/140,8/160,9/180,10/200} {
        \begin{minipage}[t]{0.23\textwidth}
            \centering
            \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/visual/CGAN/cgan_sample_epoch_\ep.png}
            \caption*{CGAN \ep~epoch}
        \end{minipage}
        \ifnum\i=4 \par\vspace{0.2cm}\fi
        \ifnum\i=8 \par\vspace{0.2cm}\fi
    }
    \caption{CGANä¸åŒepochç”Ÿæˆæ ·æœ¬}
    \label{fig:cgan_epochs}
\end{figure}


\newpage
% ===== WGAN-GP ç»“æœå±•ç¤º =====
\subsection{WGAN-GPä¸åŒepochç”Ÿæˆçš„æ ·æœ¬}
\vspace{1.5cm}
\begin{figure}[htbp]
    \centering
    \foreach \i/\ep in {1/20,2/40,3/60,4/80,5/100,6/120,7/140,8/160,9/180,10/200} {
        \begin{minipage}[t]{0.23\textwidth}
            \centering
            \includegraphics[width=\textwidth]{/Users/slkgaw/Proj/GANS/visual/WGAN-GP//wgan_gp_sample_epoch_\ep.png}
            \caption*{WGAN-GP \ep~epoch}
        \end{minipage}
        \ifnum\i=4 \par\vspace{0.2cm}\fi
        \ifnum\i=8 \par\vspace{0.2cm}\fi
    }
    \caption{WGAN-GPä¸åŒepochç”Ÿæˆæ ·æœ¬}
    \label{fig:wgan_gp_epochs}
\end{figure}

\newpage
% ==== BigGAN æŒ‰ç±»åˆ«éšæœºæ ·æœ¬ ====
\subsection{BigGANæŒ‰ç±»åˆ«ç”Ÿæˆæ ·æœ¬å±•ç¤º 128x128}
\begin{center}
\foreach \i in {1,...,7} {
    \includegraphics[width=0.8\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/128_by_class/\i.jpg}
    \par\vspace{0.1cm}
}
\end{center}
% æ¯é¡µ7å¼ å›¾ç‰‡ï¼Œå…±9é¡µ
\foreach \page in {1,...,7} {
    \begin{figure}[htbp]
        \centering
        \foreach \i in {1,...,7} {
            \pgfmathtruncatemacro{\imgnum}{\page*7+\i}
            \ifnum\imgnum<57
                \includegraphics[width=0.8\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/128_by_class/\imgnum.jpg}
                \par\vspace{0.2cm}
            \fi
        }
        \caption*{BigGANæŒ‰ç±»åˆ«ç”Ÿæˆæ ·æœ¬ï¼ˆç¬¬\the\numexpr\page+1\relax é¡µï¼‰}
    \end{figure}
}

\newpage

\subsection{BigGANéšæœºæ ·æœ¬å±•ç¤º 128x128}
\vspace{1cm}
\begin{center}
\foreach \i in {1,...,3} {
    \includegraphics[width=0.8\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/128_random/\i.jpg}
    \par\vspace{0.2cm}
}
\end{center}

\foreach \page in {1,...,2} {
    \begin{figure}[htbp]
        \centering
        \foreach \i in {1,...,3} {
            \pgfmathtruncatemacro{\imgnum}{\page*3+\i}
            \ifnum\imgnum<10
                \includegraphics[width=0.8\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/128_random/\imgnum.jpg}
                \par\vspace{0.2cm}
            \fi
        }
        \caption*{BigGANéšæœºæ ·æœ¬å±•ç¤ºï¼ˆç¬¬\the\numexpr\page+1\relax é¡µï¼‰}
    \end{figure}
}

\subsection{BigGANéšæœºæ ·æœ¬å±•ç¤º 512x512}
\vspace{1cm}
\begin{center}
\foreach \i in {1,...,3} {
    \includegraphics[width=0.8\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/512_random/\i.jpg}
    \par\vspace{0.2cm}
}
\end{center}

\foreach \page in {1} {
    \begin{figure}[htbp]
        \centering
        \foreach \i in {1,...,3} {
            \pgfmathtruncatemacro{\imgnum}{\page*3+\i}
            \ifnum\imgnum<6
                \includegraphics[width=0.8\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/512_random/\imgnum.jpg}
                \par\vspace{1cm}
            \fi
        }
        \caption*{BigGANéšæœºæ ·æœ¬å±•ç¤ºï¼ˆç¬¬\the\numexpr\page+1\relax é¡µï¼‰}
    \end{figure}
}


\subsection{BigGANä¸åŒç±»åˆ«é—´æ’å€¼é‡‡æ ·}
\vspace{1cm}
\begin{center}
\foreach \i in {1,...,8} {
    \includegraphics[width=0.8\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/interpolation/\i.png}
    \par\vspace{1cm}
}
\end{center}
\foreach \page in {1,2,3,4} {
    \begin{figure}[htbp]
        \centering
        \foreach \i in {1,...,8} {
            \pgfmathtruncatemacro{\imgnum}{\page*3+\i}
            \ifnum\imgnum<41
                \includegraphics[width=0.8\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/interpolation/\imgnum.png}
                \par\vspace{1cm}
            \fi
        }
        \caption*{BigGANä¸åŒç±»åˆ«é—´æ’å€¼å±•ç¤ºï¼ˆç¬¬\the\numexpr\page+1\relax é¡µï¼‰}
    \end{figure}
}

\newpage
\subsection{AninmalFacesæ•°æ®é›†å±•ç¤º}
\begin{figure}[H]
    \centering
    \includegraphics[width=1.0\textwidth]{/Users/slkgaw/Proj/GANS/BigGAN/batch_sample.png}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[width=1.0\textwidth]{/Users/slkgaw/Proj/GANS/visual/BigGAN/batch_sample.png}
\end{figure}
\end{document}

